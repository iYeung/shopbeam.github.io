(function(a){a.fn.tab=function(c,b){if(typeof c==="object"){b=c}b=a.extend({defaultOpen:(c&&typeof c==="number"&&c>0)?--c:0,tabKeyword:"tab",tabHiddenClass:"tab-hidden",tabListClass:"tab-list",tabActiveClass:"tab-active",tabEvent:"click",timer:0,animateUserAction:true,paginate:false,pause:false,cloneHeading:false,autopause:{selector:""},fx:{change:"standard",duration:"normal"}},b||{});return this.each(function(){var m=this;var g=null;var r=a(this).find("."+b.tabKeyword);var l=a("<ul>");l.addClass(b.tabListClass);if(b.paginate===true){var d=a('<li class="'+b.tabKeyword+"-paginate "+b.tabKeyword+'-back">Back</li>').bind(b.tabEvent,function(i){clearInterval(n);j(-1,i)});var q=a('<li class="'+b.tabKeyword+"-paginate "+b.tabKeyword+'-forward">Forward</li>').bind(b.tabEvent,function(i){clearInterval(n);j(1,i)});l.append(d)}var s=[];r.each(function(v){var y=a(this);var i=a('<li id="'+b.tabKeyword+"-"+y.attr("id")+'" class="'+b.tabKeyword+"-"+v+'"><a href="#'+y.attr("id")+'"></a></li>');var A=y.html();i.find("a").append(A);i.children("a").bind(b.tabEvent,function(B){clearInterval(n);j(this,B)});l.append(i);var z=a("<div>");var t=y.get()[0];if(b.cloneHeading===true){var x=a(y).clone().attr("id",function(){return this.id+"-tab-heading"});z.append(x)}while(t.nextSibling&&t.nextSibling.nodeName!==t.nodeName){z.append(a(t.nextSibling))}var u=y.attr("id");y.remove();try{z.attr("id",u).addClass(b.tabKeyword).addClass(b.tabKeyword+"-"+v);s.push(z)}catch(w){}});if(b.paginate===true){l.append(q)}if(b.pause===true){var f=a('<li class="'+b.tabKeyword+'-pause">Pause</li>').bind(b.tabEvent,function(i){h(i)});l.append(f)}a(this).append(l);for(var k=0,p=s.length;k<p;k++){if(b.defaultOpen!==k){s[k].addClass(b.tabHiddenClass)}a(this).append(s[k])}l.find("li[id*="+b.tabKeyword+"-]").each(function(i){if(i===b.defaultOpen){g=CN.dom.storage.activateElement(a(this).get()[0],g,b.tabActiveClass)}});var n=null;if(b.timer>0){n=setInterval(function(){j(1)},b.timer*1000)}a(m).parent().attr("data-tab-timer",n);var j=function(v,z){if(typeof v==="number"){var i=l.find("li."+b.tabActiveClass).eq(0);switch(v){case -1:v=a(i).prev().find("a").attr("href");if(typeof v==="undefined"){v=a(l).find("li[id*="+b.tabKeyword+"-]").filter(":last").find("a").attr("href")}break;case 1:v=a(i).next().find("a").attr("href");if(typeof v==="undefined"){v=a(l).find("li[id*="+b.tabKeyword+"-]").filter(":first").find("a").attr("href")}break;default:break}}var x=v.toString().split("#");var y=x[1];var B=a("#"+y);var w=g.toString().split("#")[1];if(b.autopause.selector!==""&&a(b.autopause.selector,B).length>0){clearInterval(n)}if(o.hasOwnProperty(b.fx.change)){if(!z||(z&&b.animateUserAction===true)){o[b.fx.change](w,B)}else{o.standard(w,B)}}else{o.standard(w,B)}var A=null;l.find("li[id*="+b.tabKeyword+"-]").each(function(C,D){if(a(D).hasClass(b.tabActiveClass)){A=D}});CN.dom.storage.deactivateElement(A,g,b.tabActiveClass);var u=b.tabKeyword+"-"+B.attr("id");var t=document.getElementById(u);g=CN.dom.storage.activateElement(t,g,b.tabActiveClass);if(z){z.preventDefault();z.stopPropagation()}};var h=function(u){var i=a(u.target);clearInterval(n);i.unbind().text("Play").attr("class","tab-play");i.bind(b.tabEvent,function(t){e(t);return false})};var e=function(u){var i=a(u.target);n=null;j(1);if(b.timer>0){n=setInterval(function(){j(1)},b.timer*1000)}i.unbind().text("Pause").attr("class","tab-pause");i.bind(b.tabEvent,function(t){h(t);return false})};var o={standard:function(i,t){a("div."+b.tabKeyword).attr("style","");a("#"+i).addClass(b.tabHiddenClass);t.removeClass(b.tabHiddenClass)},crossfade:function(i,t){a("#"+i).animate({opacity:0},b.fx.duration,function(){a(this).addClass(b.tabHiddenClass)});t.animate({opacity:1},b.fx.duration,function(){a(this).removeClass(b.tabHiddenClass)})},textfade:function(t,u){var i=["rubric","feature-header","feature-blurb-text","byline"];a(window).trigger("CN.customEvents.rotator.slidechange");u.fadeIn(b.fx.duration,function(){a(".rotator-content").fadeIn("slow",function(){a.each(i,function(v,w){setTimeout(function(){a(".rotator-content ."+i[v],u).fadeIn("slow")},600*v)})})}).removeClass(b.tabHiddenClass);a("#"+t).fadeOut(b.fx.duration,function(){a(this).addClass(b.tabHiddenClass);a(".rotator-content",a(this)).children().css("display","none")})}}})}})(jQuery);