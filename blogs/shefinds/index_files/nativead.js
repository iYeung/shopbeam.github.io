(function(){glam.create.define("nativead",["domready"],function(n){function g(a){var h={api_url:!1,api_callback_fn:!1,list_insertion_index:1,asset_base:"",click_prefix:"",tracker:!1,template_handlers:!1};if(a)for(var b in a)a.hasOwnProperty(b)&&(h[b]=a[b]);this.a=h;this.g=this.b=this.c=!1;this.errors=[];this.a.api_url&&this.a.api_callback_fn&&this.m()}g.prototype={d:function(a){this.errors.push(a);this.e(a,!0)},e:function(a,h){if(window.console)window.console[h?"error":"log"]("na: "+a)},m:function(){if("string"!=
typeof this.a.api_url||"string"!=typeof this.a.api_callback_fn)return this.d("missing API details");if(void 0===window.glam_affiliate_id)return this.d("missing affid");var a=this,h=document.createElement("script");window[this.a.api_callback_fn]=function(b){a.l(b)};h.src=this.a.api_url.replace("@id",window.glam_affiliate_id);document.body.appendChild(h)},n:function(){if(1>this.b.length)return this.d("no site conf");for(var a=0,h=this.b.length,b,m="verify"==this.h,d,e;a<h;a++)if(b=this.b[a],m||this.h===
b.unit_type&&("*"===this.f||this.f===b.insertion_type)){d=!1;e=b.selector_type;"into"==e&&(d=document.querySelector(b.selector));if("before"==e||"after"==e)d=document.querySelector(b.selector);if("list"==e){var c=document.querySelectorAll(b.selector);c.length&&(d=Math.min(c.length,this.a.list_insertion_index),c.length==d&&c[c.length-1]?(e="into",d=c[d-1].parentNode):c[d-1]&&c[d-1].parentNode!=c[d].parentNode?(e="after",d=c[d-1]):(e="before",d=c[d]))}if(m)b.isvalid=!!d;else if(d){this.o=a;this.c=d;
this.k=e;break}}},i:function(a){function h(){n(function(){b.n();b.g=!!b.c;a()})}var b=this;b.b?h():this.j=h},p:function(a,h){var b=this;return a.replace(RegExp("{{\\s*([a-z0-9_][\\.a-z0-9_]*)(?:\\[(\\w+=[\\w/ _,-]+)\\])?\\s*}}","gi"),function(a,d,e){var c=d.split("."),g=c.length,f=h,k=0,l=b.a.template_handlers[c[0]];e&&(e=e.split("="));if(l)"function"==typeof l?f=l(d,e):(b.e("invalid custom handler for '"+c[k]+"'",!0),f="");else for(;k<g;k++){f=f[c[k]];if(void 0===f){b.e("'"+c[k]+"' not found in "+
a,!0);f="";break}if(k===g-1)break}e&&("trim"===e[0]&&(a=f.replace(/<(?:.|\n)*?>/gm,""),d=e[1],a=(f=a.length>d)?a.substr(0,d-1):a,a=f?a.substr(0,a.lastIndexOf(" ")):a,f=f?a+" &hellip;":a),"upper"===e[0]&&(f=f.toUpperCase()),"img"===c[0]&&"var"===e[0]&&(e=h[c[0]][c[1]+"_"+e[1]],void 0!==e&&(f=e)));if("img"===c[0]||"img"===c[1])f=(/^http/.test(f)?"":b.a.asset_base)+f;if("link"===c[0]||"link"===c[1]&&10<f.length)f=b.a.click_prefix+f;"body"===c[0]&&b.a.tracker&&(f=f.replace("{{tracker}}",b.a.tracker.flashRef));
return f})},l:function(a){a?(this.b=a,this.j&&this.j()):this.d("invalid config")},s:function(a){var h=this;this.h="verify";this.f="*";this.i(function(){a(h.b)})},r:function(a,h,b){var g=this;this.h=a;this.f=h;this.i(function(){b(g.g?g.b[g.o]:!1)})},q:function(a){return this.g?"into"==this.k?this.c.appendChild(a):this.c.parentNode.insertBefore(a,"after"==this.k?this.c.nextSibling:this.c):!1}};g.prototype.verify=g.prototype.s;g.prototype.insert=g.prototype.q;g.prototype.setup=g.prototype.r;g.prototype.doTemplate=
g.prototype.p;g.prototype.setSiteConfig=g.prototype.l;return g});})();
