/*!CK:2498032671!*//*1380514705,178138187*/

if (self.CavalryLogger) { CavalryLogger.start_js(["MIbPP"]); }

__d("BlackbirdUpsellConstants",[],function(a,b,c,d,e,f){e.exports={ACTION_UPSELL:"upsell",CLICK_TYPE_DISMISS_PROMO:"dismiss_promo",ACTION_EDUCATE:"educate",CLICK_TYPE_ENABLE_CHAT:"enable_chat",CLICK_TYPE_OPEN_SETTINGS:"open_settings"};});
__d("AsyncLoader",["copyProperties","AsyncRequest","BaseAsyncLoader"],function(a,b,c,d,e,f){var g=b('copyProperties'),h=b('AsyncRequest'),i=b('BaseAsyncLoader');function j(k,l){this._endpoint=k;this._type=l;}g(j.prototype,i.prototype);j.prototype.send=function(k,l,m,n,o){new h(k).setData({ids:l}).setHandler(n).setErrorHandler(o).setAllowCrossPageTransition(true).setMethod('GET').setReadOnly(true).send();};e.exports=j;});
__d("ChannelSubdomain",["Cookie","JSLogger"],function(a,b,c,d,e,f){var g=b('Cookie'),h=b('JSLogger'),i=h.create('channel'),j=7,k=null;function l(o,p){var q=null,r=m(),s;o--;var t=Math.min(32,j*o);t=Math.max(t,1);var u=false;for(var v=0;v<32;v++){s=(v+p)%t;if(!(r&(1<<s))){u=true;break;}}if(u){k=s;q=k%j;g.set('sub',r|(1<<k));}else{k=-1;q=null;i.error('subdomain_overflow',{slot:k,max:o});}return q;}function m(){var o=g.get('sub')||0;o=parseInt(o,10);return isNaN(o)?0:o;}function n(){if(k!==null&&k>=0){var o=m()&~(1<<k);if(o){g.set('sub',o);}else g.clear('sub');}}e.exports={allocate:l,clear:n};});
__d("ChannelTransport",["copyProperties","bind","AjaxRequest","URI","JSLogger","DocRPC","ChannelConstants","UserAgent"],function(a,b,c,d,e,f){var g=b('copyProperties'),h=b('bind'),i=b('AjaxRequest'),j=b('URI'),k=b('JSLogger'),l=b('DocRPC'),m=b('ChannelConstants'),n=b('UserAgent'),o=k.create('channel');function p(){return (1048576*Math.random()|0).toString(36);}function q(y,z){var aa=y.subdomain;aa=aa===null?'':(aa+'-');var ba=new j(z).setDomain(aa+y.host+'.facebook.com').setPort(y.port).setSecure(j().isSecure());return ba;}function r(y){var z={partition:y.partition,cb:p()},aa=q(y,'/p').setQueryData(z);o.log('start_p',{uri:aa.toString()});var ba=new i('GET',aa);if(i.supportsCORS())ba.xhr.withCredentials=true;var ca=function(da){o.log('finish_p',{xhr:da.toJSON?da.toJSON():da});};ba.timeout=y.P_TIMEOUT;ba.onError=ba.onSuccess=ca;ba.send();}function s(y,z,aa){var ba=new Image(),ca=0,da=function(ga){ba.abort();return ga?z():aa();};ba.onload=function(){o.log('ping_ok',{duration:Date.now()-ca});da(true);};ba.onerror=function(){r(y);da(false);};var ea=setTimeout(ba.onerror,10000,false);ba.abort=function(){if(ea){clearTimeout(ea);ea=null;}ba.onload=ba.onerror=null;};var fa={partition:y.partition,cb:p()};ca=Date.now();ba.src=q(y,'/ping').setQueryData(fa);return ba;}function t(y,z,aa,ba){var ca=new Date(),da=(ca-y.userActive)/1000|0;if(da<0)o.warn('idle_regression',{idleTime:da,now:ca.getTime(),userActive:y.userActive});var ea={channel:y.user_channel,seq:y.seq,partition:y.partition,clientid:y.sessionID,cb:p(),idle:da,cap:0};if(da<60)ea.state='active';if(y.streamingCapable){ea.mode='stream';ea.format='json';}if(y.profile)ea.profile=y.profile;if(y.webrtcSupport&&(n.chrome()>=24||n.firefox()>=22))ea.cap=m.CAPABILITY_VOIP;var fa=q(y,'/pull').setQueryData(ea),ga=new i('GET',fa);if(i.supportsCORS())ga.xhr.withCredentials=true;ga.timeout=y.streamingCapable?y.STREAMING_TIMEOUT:y.LONGPOLL_TIMEOUT;ga.onJSON=z;ga.onSuccess=aa;ga.onError=function(){var ha=(this.status==12002&&this._time>=y.MIN_12002_TIMEOUT)||(this.status==504&&this._time>=y.MIN_504_TIMEOUT),ia=ha?aa:ba;return ia&&ia.apply(this,arguments);};ga.send();y.inStreaming=y.streamingCapable;return ga;}function u(y){this.manager=y;(this.init&&this.init());}function v(y){u.apply(this,arguments);}g(v.prototype,{logName:'CORS',enterState:function(y,z){if(this._request){this._request.abort();this._request=null;}if(y=='init')setTimeout(h(this.manager,'exitState',{status:m.OK,stateId:z.stateId}),3000,false);if(!/pull|ping/.test(y))return;var aa=this.manager;if(y=='ping'){this._request=s(z,h(aa,'exitState',{status:m.OK,stateId:z.stateId}),h(aa,'exitState',{status:m.ERROR,stateId:z.stateId}));}else if(y=='pull')this._request=t(z,h(aa,'_processTransportData',z.stateId),h(aa,'exitState',{status:m.OK,stateId:z.stateId}),h(aa,'exitState',{status:m.ERROR,stateId:z.stateId}));}});function w(y){o.log('iframe_init_constructor');u.apply(this,arguments);this._iframe=document.createElement('iframe');this._iframe.style.display='none';document.body.appendChild(this._iframe);l.publish(this,'outerTransport');}g(w.prototype,{logName:'iframe',_initIframe:function(y){o.log('iframe_init_start');window.onchanneliframeready=function(){o.log('iframe_resources');return y.resources;};window.onchanneliframeloaded=function(){o.log('iframe_loaded');};if(y){this._iframeURI=q(y,y.path);if(y.bustIframe){var z={partition:y.partition,cb:p()};this._iframeURI.setQueryData(z);}}else this._iframeURI='about:blank';this._iframeProxy=null;try{this._iframe.contentWindow.location.replace(this._iframeURI);o.log('iframe_uri_set');}catch(aa){o.error('iframe_uri_set_error',aa);this.exitState({status:m.ERROR,stateId:y.stateId},aa+'');}},enterState:function(y,z){if(y=='init'){this._initIframe(z);}else if(/idle|ping|pull/.test(y)){if(this._iframeProxy){this._iframeProxy.enterState.apply(this._iframeProxy,arguments);}else if(y!='idle')this.exitState({status:m.ERROR,stateId:z.stateId},'iframe not yet loaded');}else if(y=='shutdown')this._initIframe();},_processTransportData:function(){this.manager._processTransportData.apply(this.manager,arguments);},exitState:function(y){if(this.manager.state=='init'&&y.status==m.OK)this._iframeProxy=l.proxy(this._iframe.contentWindow,'innerTransport',['enterState'],(this._iframeURI+'').replace(/iframe.*/,''));if(/ping|pull/.test(this.manager.state)&&!this._iframeProxy)return;this.manager.exitState.apply(this.manager,arguments);}});function x(){this.init=this.init.bind(this);u.apply(this,arguments);}g(x.prototype,{logName:'iframe(inner)',init:function(){l.publish(this,'innerTransport');try{var z=l.proxy(window.parent,'outerTransport',['_processTransportData','exitState'],top.DocRPC.origin);g(this,z);this.exitState({status:m.OK,stateId:1e+06});}catch(y){o.error('iframe_inner_init_error',y);}},enterState:function(y,z){if(this._request){this._request.abort();this._request=null;}if(y=='ping'){this._request=s(z,h(this,'exitState',{status:m.OK,stateId:z.stateId}),h(this,'exitState',{status:m.ERROR,stateId:z.stateId}));}else if(y=='pull')this._request=t(z,h(this,'_processTransportData',z.stateId),h(this,'exitState',{status:m.OK,stateId:z.stateId}),h(this,'exitState',{status:m.ERROR,stateId:z.stateId}));}});e.exports={getURI:q,Transport:u,CORSTransport:v,IframeTransport:w,IframeInnerTransport:x};});
__d("MovingStat",[],function(a,b,c,d,e,f){function g(h){h=h||60000;var i={t:new Date(),count:0,v:0},j=i,k=0,l=0;function m(){var n=new Date()-h;while(j&&j.next&&j.t<n){k-=j.v;l-=j.count;j=j.next;}}this.add=function(n){k+=n;l++;var o=new Date();if(o-i.t<1000){i.v+=n;i.count++;}else{i.next={t:o,v:n,count:1};i=i.next;m();}};this.tally=function(n){n=n||1000;m();return {sum:k,count:l,timeAverage:k*n/h};};}e.exports=g;});
__d("PresencePrivacy",["Arbiter","AsyncRequest","ChannelConstants","copyProperties","Env","JSLogger","PresenceUtil","PresencePrivacyInitialData"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('AsyncRequest'),i=b('ChannelConstants'),j=b('copyProperties'),k=b('Env'),l=b('JSLogger'),m=b('PresenceUtil'),n=b('PresencePrivacyInitialData'),o='/ajax/chat/privacy/settings.php',p='/ajax/chat/privacy/online_policy.php',q='/ajax/chat/privacy/visibility.php',r='friend_visibility',s='visibility',t='online_policy',u=j({},n.privacyData),v=n.visibility,w=j({},n.privacyData),x=v,y=n.onlinePolicy,z=y,aa=[],ba=false;function ca(){return l.create('blackbird');}var da=j(new g(),{WHITELISTED:1,BLACKLISTED:-1,UNLISTED:0,ONLINE:1,OFFLINE:0,ONLINE_TO_WHITELIST:0,ONLINE_TO_BLACKLIST:1});function ea(qa){var ra;for(ra in qa){var sa=qa[ra];if(ra==k.user){ca().error('set_viewer_visibility');throw new Error("Invalid to set current user's visibility");}switch(sa){case da.WHITELISTED:case da.BLACKLISTED:case da.UNLISTED:break;default:ca().error('set_invalid_friend_visibility',{id:ra,value:sa});throw new Error("Invalid state: "+sa);}}for(ra in qa)u[ra]=qa[ra];da.inform('privacy-changed');}function fa(qa,ra){var sa={};sa[qa]=ra;ea(sa);}function ga(qa){switch(qa){case da.ONLINE:case da.OFFLINE:break;default:ca().error('set_invalid_visibility',{value:qa});throw new Error("Invalid visibility: "+qa);}v=qa;da.inform('privacy-changed');da.inform('privacy-user-presence-changed');g.inform('chat/visibility-changed',{sender:this});}function ha(qa){switch(qa){case da.ONLINE_TO_WHITELIST:case da.ONLINE_TO_BLACKLIST:break;default:throw new Error("Invalid default online policy: "+qa);}y=qa;da.inform('privacy-user-presence-changed');da.inform('privacy-changed');}function ia(qa,ra){ba=true;qa.send();}function ja(qa,ra){aa.push({request:qa,data:ra});if(!ba){var sa=aa.shift();ia(sa.request,sa.data);}}function ka(qa,ra){var sa=qa.type;if(sa===r){var ta=ra.payload.user_availabilities;if(!Array.isArray(ta)){da.inform('privacy-availability-changed',{user_availabilities:ta});for(var ua in qa.settings)w[ua]=qa.settings[ua];}}else{if(sa===s){x=qa.visibility;}else if(sa===t)z=qa.online_policy;da.inform('privacy-user-presence-response');}ca().log('set_update_response',{data:qa,response:ra});}function la(qa,ra){if(v!==x)ga(x);if(y!==z)ha(z);j(u,w);da.inform('privacy-changed');aa=[];ca().log('set_error_response',{data:qa,response:ra});}function ma(qa){ba=false;if(aa.length>0){var ra=aa.shift();ia(ra.request,ra.data);}}function na(qa,ra){if(m!=null){var sa=qa.getData();sa.window_id=m.getSessionID();qa.setData(sa);}qa.setHandler(ka.bind(this,ra)).setErrorHandler(la.bind(this,ra)).setTransportErrorHandler(la.bind(this,ra)).setFinallyHandler(ma.bind(this)).setAllowCrossPageTransition(true);return qa;}function oa(qa,ra,sa){return na(new h(qa).setData(ra),sa);}function pa(qa,ra){var sa=ra.obj;if(sa.viewer_id!=k.user){ca().error('invalid_viewer_for_channel_message',{type:qa,data:ra});throw new Error("Viewer got from the channel is not the real viewer");}if(sa.window_id===m.getSessionID())return;var ta=sa.data;if(sa.event=='access_control_entry'){ta.target_ids.forEach(function(va){fa(va,ta.setting);w[va]=ta.setting;});}else{if(sa.event=='visibility_update'){var ua=!!ta.visibility?da.ONLINE:da.OFFLINE;ga(ua);x=ua;}else if(sa.event=='online_policy_update'){ha(ta.online_policy);z=ta.online_policy;}da.inform('privacy-user-presence-response');}ca().log('channel_message_received',{data:ra.obj});}j(da,{WHITELISTED:1,BLACKLISTED:-1,UNLISTED:0,ONLINE:1,OFFLINE:0,ONLINE_TO_WHITELIST:0,ONLINE_TO_BLACKLIST:1,init:function(qa,ra,sa){},setVisibility:function(qa){x=v;ga(qa);var ra={visibility:qa},sa={type:s,visibility:qa},ta=oa(q,ra,sa);ja(ta,sa);ca().log('set_visibility',{data:ra});return qa;},getVisibility:function(){return v;},setOnlinePolicy:function(qa){z=y;ha(qa);var ra={online_policy:qa},sa={type:t,online_policy:qa},ta=oa(p,ra,sa);ja(ta,sa);ca().log('set_online_policy',{data:ra});return qa;},getOnlinePolicy:function(){return y;},getFriendVisibility:function(qa){return u[qa]||da.UNLISTED;},allows:function(qa){if(this.getVisibility()===da.OFFLINE)return false;var ra=this.getOnlinePolicy();return ra===da.ONLINE_TO_WHITELIST?u[qa]==da.WHITELISTED:u[qa]!=da.BLACKLISTED;},setFriendsVisibility:function(qa,ra){if(qa.length>0){var sa={};for(var ta=0;ta<qa.length;ta++){var ua=qa[ta];w[ua]=u[ua];sa[ua]=ra;}ea(sa);var va=ra;if(va==da.UNLISTED)va=w[qa[0]];var wa={users:qa,setting:ra,setting_type:va},xa={type:r,settings:sa},ya=oa(o,wa,xa);ja(ya,xa);ca().log('set_friend_visibility',{data:wa});}return ra;},setFriendVisibilityMap:function(qa,ra){for(var sa in qa)w[sa]=u[sa];ea(qa);var ta={type:r,settings:qa};ja(na(ra,ta),ta);ca().log('set_friend_visibility_from_map',{data:qa});},allow:function(qa){if(this.allows(qa)){ca().error('allow_already_allowed');throw new Error("allow() should only be called for users that "+"are not already allowed");}if(this.getVisibility()===da.OFFLINE){ca().error('allow_called_while_offline');throw new Error("allow() should only be called when the user is already online");}var ra=this.getOnlinePolicy()===da.ONLINE_TO_WHITELIST?da.WHITELISTED:da.UNLISTED;return this.setFriendsVisibility([qa],ra);},disallow:function(qa){if(!this.allows(qa)){ca().error('disallow_already_disallowed');throw new Error("disallow() should only be called for users that "+"are not already disallowed");}if(this.getVisibility()===da.OFFLINE){ca().error('disallow_called_while_offline');throw new Error("disallow() should only be called when the user is already online");}var ra=this.getOnlinePolicy()===da.ONLINE_TO_BLACKLIST?da.BLACKLISTED:da.UNLISTED;return this.setFriendsVisibility([qa],ra);},getBlacklist:function(){var qa=[];for(var ra in u)if(u[ra]===da.BLACKLISTED)qa.push(ra);return qa;},getWhitelist:function(){var qa=[];for(var ra in u)if(u[ra]===da.WHITELISTED)qa.push(ra);return qa;},getMapForTest:function(){return u;},setMapForTest:function(qa){u=qa;}});da.inform('privacy-changed');da.inform('privacy-user-presence-changed');ca().log('initialized',{visibility:v,policy:y});g.subscribe(i.getArbiterType('privacy_changed'),pa.bind(this));g.subscribe(i.ON_CONFIG,function(qa,ra){var sa=ra.getConfig('visibility',null);if(sa!==null&&typeof(sa)!=='undefined'){var ta=sa?da.ONLINE:da.OFFLINE;ga(ta);ca().log('config_visibility',{vis:ta});}}.bind(this));a.PresencePrivacy=e.exports=da;},3);
__d("ChatVisibility",["Arbiter","JSLogger","PresencePrivacy"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('JSLogger'),i=b('PresencePrivacy'),j={isOnline:function(){return i.getVisibility()===i.ONLINE;},hasBlackbirdEnabled:function(){return this.isVisibleToMostFriends()||this.isVisibleToSomeFriends();},isVisibleToMostFriends:function(){return i.getOnlinePolicy()===i.ONLINE_TO_BLACKLIST&&i.getBlacklist().length>0;},isVisibleToSomeFriends:function(){return i.getOnlinePolicy()===i.ONLINE_TO_WHITELIST&&i.getWhitelist().length>0;},goOnline:function(k){if(i.getVisibility()===i.OFFLINE){h.create('blackbird').log('chat_go_online');i.setVisibility(i.ONLINE);g.inform('chat-visibility/go-online');}k&&k();},goOffline:function(k){if(i.getVisibility()===i.ONLINE){h.create('blackbird').log('chat_go_offline');i.setVisibility(i.OFFLINE);g.inform('chat-visibility/go-offline');}k&&k();},toggleVisibility:function(){if(j.isOnline()){j.goOffline();}else j.goOnline();}};a.ChatVisibility=e.exports=j;},3);
__d("ChannelManager",["Event","function-extensions","AjaxRequest","Arbiter","AsyncRequest","ChannelConstants","ChannelInitialData","ChannelSubdomain","ChannelTransport","Env","FBAjaxRequest","JSLogger","MovingStat","PresenceCookieManager","PresenceState","PresenceUtil","Run","SystemEvents","URI","UserActivity","copyProperties","createArrayFrom","ChatVisibility"],function(a,b,c,d,e,f){var g=b('Event');b('function-extensions');var h=b('AjaxRequest'),i=b('Arbiter'),j=b('AsyncRequest'),k=b('ChannelConstants'),l=b('ChannelInitialData'),m=b('ChannelSubdomain'),n=b('ChannelTransport'),o=b('Env'),p=b('FBAjaxRequest'),q=b('JSLogger'),r=b('MovingStat'),s=b('PresenceCookieManager'),t=b('PresenceState'),u=b('PresenceUtil'),v=b('Run'),w=b('SystemEvents'),x=b('URI'),y=b('UserActivity'),z=b('copyProperties'),aa=b('createArrayFrom'),ba=b('ChatVisibility'),ca,da=q.create('channel'),ea=null;function fa(qa){ea=qa;}var ga={idle:{ok:'init!'},init:{ok:'pull!',error:'reconnect',sys_online:'init',sys_timetravel:'init'},pull:{ok:'pull!',error:'ping',error_missing:'pull',error_msg_type:'pull',refresh_0:'reconnect',refresh_110:'reconnect',refresh_111:'reconnect',refresh_112:'pull',refresh_113:'pull',refresh_117:'reconnect'},ping:{ok:'pull!',error:'ping',error_stale:'reconnect!'},reconnect:{ok:'init!',error:'reconnect',sys_online:'reconnect',sys_timetravel:'reconnect'},shutdown:{},_all:{error_max:'shutdown!',error_shutdown:'shutdown!',sys_owner:'reconnect',sys_nonowner:'idle!',sys_online:'ping',sys_offline:'idle!',sys_timetravel:'ping'}},ha={userActive:ba.isOnline()?Date.now():0,sessionID:(Math.random()*2147483648|0).toString(16),streamingCapable:false,inStreaming:false,LONGPOLL_TIMEOUT:60000,STREAMING_TIMEOUT:60000,P_TIMEOUT:30000,IFRAME_LOAD_TIMEOUT:30000,MIN_RETRY_INTERVAL:5000,MAX_RETRY_INTERVAL:30000,MIN_12002_TIMEOUT:9000,MIN_504_TIMEOUT:20000,STALL_THRESHOLD:180000,JUMPSTART_THRESHOLD:90000,MIN_INIT_PROBE_DELAY:3000,INIT_PROBE_DELAY_RANDOMIZE_RANGE:12000,PROBE_DELAY:60000,PROBE_HEARTBEATS_INTERVAL_LOW:1000,PROBE_HEARTBEATS_INTERVAL_HIGH:3000,STREAMING_EXIT_STATE_ON_CONTINUE:false},ia=1,ja={},ka=0;function la(){return j.lastSuccessTime?Math.round((Date.now()-j.lastSuccessTime)/1000):-1;}function ma(){var qa={};if(ca.getConfig('host'))qa[ca.getConfig('user_channel')]=ca.getConfig('seq',0);return qa;}function na(){var qa=Date.now(),ra=Date.now(),sa={total:0},ta='idle',ua=false;w.subscribe([w.USER,w.ONLINE,w.TIME_TRAVEL],function(xa,ya){pa(true);ra=null;ca.lastPullTime=Date.now();var za;switch(xa){case w.USER:za=w.isPageOwner()?k.SYS_OWNER:k.SYS_NONOWNER;break;case w.ONLINE:za=ya?k.SYS_ONLINE:k.SYS_OFFLINE;break;case w.TIME_TRAVEL:za=k.SYS_TIMETRAVEL;break;}ca.exitState({status:za,stateId:ia});});var va=function(xa,ya){var za=Date.now(),ab;if(ya){qa=za;ab=ya.nextState||ya.state;}else ab=ta;w.checkTimeTravel();if(ra){var bb=Math.round((za-ra)/1000);if(bb>0){sa[ta]=(sa[ta]||0)+bb;sa.total+=bb;}}ta=ab;ra=za;if(!xa){sa.lastSuccessTime=la();sa.online=w.isOnline();da.log('rollup',sa);}};i.subscribe(k.ON_ENTER_STATE,va);setInterval(va,60000,false);i.subscribe(q.DUMP_EVENT,function(xa,ya){ya.channelRollup=sa;});var wa=function(){if(ca.isShutdown()||ca.shouldIdle())return;w.checkTimeTravel();var xa=Date.now()-(ca.lastPullTime||o.start);if(!ua&&xa>ha.STALL_THRESHOLD){var ya=la();da.error('stall',{lastSuccessTime:ya,rollupState:ta});ua=true;}var za=Date.now()-qa;if(ca.state=='pull'&&za>ha.JUMPSTART_THRESHOLD){qa=null;da.warn('jumpstart',{state:ca.state,dormant:za});ca.enterState('init');}};setInterval(wa,10000,false);}function oa(){var qa=Date.now(),ra=1;function sa(){setTimeout(sa,ra*1000,false);var xa=ca.state;if(xa=='idle'&&ca.shouldIdle())return;da.bump('conn_t',ra);if(xa=='pull')da.bump('conn_t_pull',ra);}sa();var ta=[15,30,60,120,240],ua=false,va=false;function wa(xa){setTimeout(function(){da.rate('pullenter_'+xa,ua);da.rate('pullexit_'+xa,va);},xa*1000,false);}while(ta.length)wa(ta.shift());i.subscribe(k.ON_ENTER_STATE,function(xa,ya){if(ya.state=='pull')ua=true;qa=Date.now();});i.subscribe(k.ON_EXIT_STATE,function(xa,ya){if(ya.state!='pull'||!qa)return;var za='other';if(ya.status==k.OK){va=true;za='ok';}else if(ya.xhr&&ya.xhr.errorType){za=/ar:(\w+)/.test(ya.xhr.errorType)&&RegExp.$1;}else if(/^sys_/.test(ya.status))return;var ab=(Date.now()-qa)/1000;if(ab<0){return;}else if(ab>3600)ab=3600;da.bump('conn_num');da.bump('conn_exit',ab);da.bump('conn_num_'+za);da.bump('conn_exit_'+za,ab);});}function pa(qa){if(qa){ka=0;ja={};}else ka++;}ca={state:'idle',nextState:null,lastPullTime:Date.now(),heartbeats:[],setTestCallback:fa,init:function(qa){this.init=function(){};if(typeof(y)!='undefined'){y.subscribe(function(){if(ba.isOnline())ha.userActive=Date.now();}.bind(this));}else da.error('user_activity_undefined');s.register('ch',ma);var ra=this.getConfig('max_conn',2),sa=Math.floor(Math.random()*32);ha.subdomain=m.allocate(ra,sa);if(typeof window.onpageshow!='undefined'){g.listen(window,'pagehide',m.clear);}else v.onUnload(m.clear);this._transportRate=new r(30000);var ta=(h.supportsCORS()&&!ha.forceIframe)?'CORSTransport':'IframeTransport';this.transport=new n[ta](this);if(qa)this.enterState.apply(this,arguments);i.subscribe(q.DUMP_EVENT,function(event,va){va.transportRate=this._transportRate.tally();va.transportType=ta;va.transportVersion=2;}.bind(this));na();oa();if(ca.getConfig('tryStreaming')&&ca.getConfig('host')&&h.supportsCORS()&&!ha.forceIframe){var ua=ha.MIN_INIT_PROBE_DELAY+Math.random()*ha.INIT_PROBE_DELAY_RANDOMIZE_RANGE;setTimeout(this._probeTest,ua,false);}},configure:function(){var qa=aa(arguments);da.log('configure',qa);qa.forEach(z.bind(null,ha));i.inform(k.ON_CONFIG,this);},getConfig:function(qa,ra){return qa in ha?ha[qa]:ra;},isShutdown:function(){return this.state=='shutdown';},shouldIdle:function(){return !(w.isPageOwner()&&w.isOnline());},_sendIframeError:function(qa){var ra=new j().setURI('/ajax/presence/reconnect.php').setData({reason:qa,fb_dtsg:o.fb_dtsg}).setOption('suppressErrorHandlerWarning',true).setOption('retries',1).setMethod('GET').setReadOnly(true).setAllowCrossPageTransition(true);ra.specifiesWriteRequiredParams()&&ra.send();},_getDelay:function(){var qa=Math.min(ha.MIN_RETRY_INTERVAL*Math.pow(2,Math.max(0,ka-1)),ha.MAX_RETRY_INTERVAL);return qa*(.75+Math.random()/2)|0;},enterState:function(){if(this._inEnterState)da.warn('enterstate_recursion');this._inEnterState=true;try{this._enterState.apply(this,arguments);this._inEnterState=false;}catch(qa){this._inEnterState=false;throw qa;}},_enterState:function(qa){var ra=0,sa=aa(arguments);if(this.isShutdown())return;if(qa!='idle!'&&this.shouldIdle())return;ia++;ha.stateId=ia;clearTimeout(this._deferredTransition);this._deferredTransition=null;this.transport.enterState('idle');this.state='idle';this.nextState=null;if(/!$/.test(qa)){var ta=this._transportRate.tally().timeAverage,ua=ca.getConfig('MAX_CHANNEL_STATES_PER_SEC',1);if(ta>=ua){if(!this._throttled){this._throttled=true;da.warn('throttled');}da.bump('throttle');ra=1000/ua;}}else if(!(/#$/.test(qa)))ra=this._getDelay();qa=qa.replace(/\W*$/,'');if(!ga[qa])throw new Error('invalid state:'+qa);var va;if(ra<=0){va={state:qa};this._transportRate.add(1);this.state=qa;var wa=this['_enter_'+this.state];if(wa){sa.shift();wa.apply(this,sa);}if(/init|idle|pull|ping/.test(this.state)){if(ha.streamingCapable&&/pull/.test(this.state))this.heartbeats=[];this.transport.enterState(this.state,ha);if(this.state=='ping'){va.url=n.getURI(ha).toString();va.port=ha.port||'undefined';}}}else{this.state='idle';this.nextState=qa;va={state:this.state,delay:ra,nextState:qa};sa[0]=qa+'#';this._deferredTransition=(function(){this._deferredTransition=null;this.enterState.apply(this,sa);}).bind(this).defer(ra,false);}if(/pull/.test(qa)){va.client_id=ha.sessionID;va.streaming=ha.inStreaming;}da.log('enter_'+this.state,va);i.inform(k.ON_ENTER_STATE,va);},exitState:function(qa,ra){var sa=qa.stateId,ta=qa.status;if(this.isShutdown()||sa<ia)return;var ua=aa(arguments),va=this.state;ua[0]=qa.status;var wa={state:va,status:ta};if(/pull/.test(va)){wa.client_id=ha.sessionID;wa.streaming=ha.inStreaming;}if(/ping/.test(va)&&ta!=k.OK)wa.url=n.getURI(ha).toString();if(this.nextState)wa.nextState=this.nextState;if(ra&&ra.errorType){wa.xhr=ra.toJSON?ra.toJSON():ra;delete wa.xhr.json;}if(ra&&ra.json){if(ra.json.t)wa.t=ra.json.t;if(ra.json.reason)wa.reason=ra.json.reason;if(ra.json.seq)wa.seq=ra.json.seq;}da.log('exit_'+va,wa);i.inform(k.ON_EXIT_STATE,wa);var xa=this['_exit_'+va];if(xa)ta=xa.apply(this,ua)||ta;if(ta!=k.OK){pa();ja[va]=(ja[va]||0)+1;}var ya=ga[this.nextState||va][ta]||ga._all[ta],za=ya&&ya.replace(/!*$/,'');if(!za){da.error('terminal_transition',wa);this._shutdownHint=k.HINT_INVALID_STATE;ya='shutdown!';}this._lastState=va;this._lastStatus=ta;this.enterState(ya);},_processTransportData:function(qa,ra){var sa=ra.json,ta=sa.t;if('s' in sa){sa.seq=sa.s;delete sa.s;}var ua=ha.seq;if('seq' in sa){ha.seq=sa.seq;t.doSync();}switch(ta){case 'continue':if(ha.inStreaming&&this.heartbeats.length<1){ha.streamingCapable=false;da.log('switch_to_longpoll');setTimeout(this._probeTest,ha.PROBE_DELAY,false);}pa(true);if(!ha.inStreaming||ha.STREAMING_EXIT_STATE_ON_CONTINUE)this.exitState({status:k.OK,stateId:qa});break;case 'refresh':case 'refreshDelay':this.exitState({status:'refresh_'+(sa.reason||0),stateId:qa},ra);break;case 'fullReload':s.clear();da.log('invalid_history');i.inform(k.ON_INVALID_HISTORY);this.exitState({status:k.ERROR_MISSING,stateId:qa},ra);break;case 'msg':var va,wa,xa,ya;pa(true);wa=sa.ms;xa=ha.seq-wa.length;for(va=0;va<wa.length;va++,xa++)if(xa>=ua){ya=wa[va];if(ya.type){if(ya.type==='messaging'&&ya.message){var za=ya.unread_counts&&ya.unread_counts.inbox;da.debug('message',{type:'messaging',inbox_unread:za,tid:ya.message.tid,mid:ya.message.mid});}else if(ya.type==='m_messaging'){da.debug('message',{type:'m_messaging',tid:ya.tid,mid:ya.uuid});}else da.debug('message',{type:ya.type});i.inform(k.getArbiterType(ya.type),{obj:ya});}}else da.warn('seq_regression',{seq:xa,last_seq:ua,messages:wa.length});break;case 'heartbeat':if(ha.inStreaming){var ab=Date.now();if(this.heartbeats.length>0){var bb=ab-this.heartbeats[this.heartbeats.length-1];da.log('heartbeat_interval',{client_id:ha.sessionID,interval:bb});}this.heartbeats.push(ab);}break;default:da.error('unknown_msg_type',{type:ta});break;}},_enter_init:function(){if(ja.init>=ca.getConfig('MAX_INIT_FAILS',2))return this.exitState.bind(this,{status:k.ERROR_MAX,stateId:ia}).defer();this._initTimer=this.exitState.bind(this,{status:k.ERROR,stateId:ia},'timeout').defer(ha.IFRAME_LOAD_TIMEOUT,false);},_enter_reconnect:function(qa){var ra=ia;if(!u.hasUserCookie()){da.warn('no_user_cookie');(function(){ca._shutdownHint=k.HINT_AUTH;ca.exitState({status:k.ERROR_SHUTDOWN,stateId:ra});}).defer();return;}var sa={reason:qa,fb_dtsg:o.fb_dtsg};if(o.fb_isb)sa.fb_isb=o.fb_isb;if(ea)ea(sa);var ta=new p('GET','/ajax/presence/reconnect.php',sa);ta.onSuccess=(function(){ca.configure(ta.json);s.store();this.exitState({status:k.OK,stateId:ra});}).bind(this);ta.onError=(function(){var ua=ta.json&&ta.json.error;if(ta.errorType==h.TRANSPORT_ERROR||ta.errorType==h.PROXY_ERROR)this._shutdownHint=k.HINT_CONN;if(ua&&ua==1356007){this._shutdownHint=k.HINT_MAINT;}else if(ua==1357001||ua==1357004||ua==1348009){this._shutdownHint=k.HINT_AUTH;}else this._shutdownHint=null;this.exitState({status:this._shutdownHint?k.ERROR_SHUTDOWN:k.ERROR,stateId:ra},ta);}).bind(this);ta.send();},_enter_shutdown:function(){i.inform(k.ON_SHUTDOWN,{reason:this._shutdownHint});},_exit_init:function(qa){if(this._initTimer)this._initTimer=clearTimeout(this._initTimer);if(qa==k.ERROR_MAX)this._sendIframeError(k.reason_IFrameLoadGiveUp);},_exit_pull:function(qa){if(qa==k.OK)this.lastPullTime=Date.now();},_exit_ping:function(qa){if(qa==k.OK){var ra=Date.now()-(this.lastPullTime||o.start);if(ra>ha.STALL_THRESHOLD)return k.ERROR_STALE;}},_probeTest:function(){ha.streamingCapable=false;var qa=[],ra={mode:'stream',format:'json'},sa=new x('/probe').setDomain(ha.host+'.facebook.com').setPort(ha.port).setSecure(x().isSecure()).setQueryData(ra),ta=new h('GET',sa);ta.onJSON=function(ua,va){if(ua&&ua.json&&ua.json.t==='heartbeat'){qa.push(Date.now());if(qa.length>=2){var wa=qa[1]-qa[0];if(wa>=ha.PROBE_HEARTBEATS_INTERVAL_LOW&&wa<=ha.PROBE_HEARTBEATS_INTERVAL_HIGH){ha.streamingCapable=true;da.log('switch_to_streaming');}da.log('probe_ok',{time:wa});}}};ta.onSuccess=function(ua){if(qa.length!=2){ha.streamingCapable=false;da.error('probe_error',{error:'beats.length = '+qa.length});}};ta.onError=function(ua){ha.streamingCapable=false;da.error('probe_error',ua);};da.log('probe_request');ta.send();}};e.exports=ca;if(l.channelConfig){ca.configure(l.channelConfig);if(/shutdown/.test(l.state))ca._shutdownHint=k[l.reason];ca.init(l.state,l.reason);}});
__d("ChatFavoriteList",["AsyncRequest","arrayContains","emptyFunction"],function(a,b,c,d,e,f){var g=b('AsyncRequest'),h=b('arrayContains'),i=b('emptyFunction'),j=false,k=[],l=[],m=false;function n(){var r=k.join(',');new g('/ajax/chat/favorite_list.php').setData({favorite_list:r}).setHandler(i).setErrorHandler(i).send();}function o(r){return r.toString();}function p(r){if(k.length!=r.length)return true;for(var s=0;s<r.length;s++)if(k[s]!==r[s].toString())return true;return false;}var q={isEditMode:function(){var r=null;d(['ChatSidebar'],function(s){r=s;});return j&&r&&r.isEnabled();},toggleEditMode:function(){j=!j;if(j)l=k.slice();},get:function(){if(j){return l.slice();}else return k.slice();},isFavored:function(r){return h(l,r.toString());},init:function(r){k=r.slice().map(o);l=k.slice();},toggleID:function(r){if(!j)return;r=r.toString();var s=l.indexOf(r);if(s>=0){l.splice(s,1);}else l.push(r);m=true;},hasChanged:function(){if(m){m=false;return true;}return false;},updateList:function(r){if(!j)return;l=r.map(o);},save:function(){if(p(l)){k=l;n();}}};e.exports=q;});
__d("ChatContexts",[],function(a,b,c,d,e,f){var g={};function h(k){var l=k?k.subtext:'';return l;}function i(k,l){g[k]=l;}var j={get:function(k){if(k in g){return g[k];}else return null;},update:function(k){for(var l in k)i(l,k[l]);},getShortDisplay:function(k){return h(j.get(k));}};e.exports=j;});
__d("PresenceStatus",["AvailableListConstants","ChatConfig","ChatVisibility","Env","PresencePrivacy","ServerTime","createObjectFrom"],function(a,b,c,d,e,f){var g=b('AvailableListConstants'),h=b('ChatConfig'),i=b('ChatVisibility'),j=b('Env'),k=b('PresencePrivacy'),l=b('ServerTime'),m=b('createObjectFrom'),n={},o={},p={},q={},r={},s={resetPresenceData:function(){n={};r={};q={};},reset:function(){s.resetPresenceData();o={};p={};},get:function(t){if(t==j.user)return i.isOnline()?g.ACTIVE:g.OFFLINE;var u=g.OFFLINE;if(t in n)u=n[t];if(u==g.OFFLINE)if(o[t])u=g.MOBILE;if(!k.allows(t))u=g.OFFLINE;return u;},isBirthday:function(t){return p[t];},getGroup:function(t){if(!h.get('chat_group_presence',0))return g.OFFLINE;return t.some(function(u){if(u==j.user)return false;return (s.get(u)===g.ACTIVE);})?g.ACTIVE:g.OFFLINE;},set:function(t,u,v,w){if(t==j.user)return false;switch(u){case g.OFFLINE:case g.IDLE:case g.ACTIVE:case g.MOBILE:break;default:return false;}var x=s.get(t)!=u;if(v){q[t]=l.get();r[t]=w;}n[t]=u;return x;},setMobileFriends:function(t){o=m(t);},setBirthdayFriends:function(t){p=m(t);},getOnlineIDs:function(){var t,u=[];for(t in n)if(s.get(t)===g.ACTIVE)u.push(t);return u;},getAvailableIDs:function(){var t=s.getOnlineIDs(),u;for(u in o){if(n[u])continue;t.push(u);}return t;},getOnlineCount:function(){return s.getOnlineIDs().length;},getPresenceStats:function(){var t=0,u=0,v=0,w=0,x=0;for(var y in n){t+=1;switch(s.get(y)){case g.OFFLINE:u+=1;break;case g.IDLE:v+=1;break;case g.ACTIVE:w+=1;break;case g.MOBILE:x+=1;break;default:break;}}return {total:t,offline:u,idle:v,active:w,mobile:x};},getDebugInfo:function(t){return {id:t,presence:n[t],overlaySource:r[t],overlayTime:q[t],mobile:o[t]};}};e.exports=s;});
__d("PresencePoller",["AvailableListConstants","AvailableListInitialData","BanzaiODS","ChannelImplementation","ChatContexts","ChatFavoriteList","ChatVisibility","Env","JSLogger","LastMobileActiveTimes","Poller","PresenceStatus","ServerTime","ShortProfiles","UserActivity","copyProperties","debounceAcrossTransitions"],function(a,b,c,d,e,f){var g=b('AvailableListConstants'),h=b('AvailableListInitialData'),i=b('BanzaiODS'),j=b('ChannelImplementation').instance,k=b('ChatContexts'),l=b('ChatFavoriteList'),m=b('ChatVisibility'),n=b('Env'),o=b('JSLogger'),p=b('LastMobileActiveTimes'),q=b('Poller'),r=b('PresenceStatus'),s=b('ServerTime'),t=b('ShortProfiles'),u=b('UserActivity'),v=b('copyProperties'),w=b('debounceAcrossTransitions'),x=5,y='/ajax/chat/buddy_list.php',z=1800000,aa=h.pollInterval,ba=h.lazyPollInterval,ca=h.lazyThreshold,da=o.create('available_list'),ea='presence_poller';i.setEntitySample(ea,.01);function fa(ga){this.$PresencePoller0=ga;this.$PresencePoller1=false;this.$PresencePoller2=h.chatNotif;this.$PresencePoller3=new q({interval:aa,setupRequest:this.$PresencePoller4.bind(this),clearOnQuicklingEvents:false,dontStart:true});this.$PresencePoller5=0;this.$PresencePoller6=0;this.$PresencePoller7=0;this.$PresencePoller8=0;this.$PresencePoller9=false;this.$PresencePollera=0;if(h.favoriteList)l.init(h.favoriteList);this.$PresencePollerb('available_initial_data',h.updateTime,h.availableList,h.lastActiveTimes,h.mobileFriends,h.birthdayFriends);u.subscribe(function(ha,ia){if(ia.idleness>aa)this.forceUpdate();}.bind(this));}fa.prototype.start=function(){this.$PresencePoller3.start.bind(this.$PresencePoller3).defer();};fa.prototype.forceUpdate=function(){if(!this.$PresencePoller9)this.$PresencePoller3.request();};fa.prototype.getIsUserIdle=function(){return this.$PresencePoller1;};fa.prototype.getWebChatNotification=function(){return this.$PresencePoller2;};fa.prototype.getCallback=function(){return this.$PresencePoller0;};fa.prototype.$PresencePollerc=function(){return w(function(){this.$PresencePoller0(g.ON_AVAILABILITY_CHANGED);}.bind(this),0)();};fa.prototype.$PresencePollerb=function(ga,ha,ia,ja,ka,la){this.$PresencePoller6=ha;if(!Array.isArray(ia)){r.resetPresenceData();for(var ma in ia)r.set(ma,ia[ma].a,false,ga);}if(ja)p.update(ja,ha);if(ka)r.setMobileFriends(ka);if(la)r.setBirthdayFriends(la);this.$PresencePollerc();};fa.prototype.$PresencePoller4=function(ga){if(j.isShutdown()||!m.isOnline()){this.$PresencePoller3.skip();i.bumpEntityKey(ea,'skip.offline');return;}if(Date.now()-this.$PresencePoller5<aa){this.$PresencePoller3.skip();i.bumpEntityKey(ea,'skip.recent');return;}i.bumpEntityKey(ea,'request');this.$PresencePoller5=Date.now();var ha=(Date.now()-this.$PresencePoller8>z),ia=t.getCachedProfileIDs().join(",");this.$PresencePoller9=true;ga.setHandler(this.$PresencePollerd.bind(this)).setErrorHandler(this.$PresencePollere.bind(this)).setOption('suppressErrorAlerts',true).setOption('retries',1).setData({user:n.user,cached_user_info_ids:ia,fetch_mobile:ha}).setURI(y).setAllowCrossPageTransition(true);};fa.prototype.$PresencePollerd=function(ga){var ha=ga.getPayload(),ia=ha.buddy_list;if(!ia){this.$PresencePollere(ga);return;}i.bumpEntityKey(ea,'response');this.$PresencePoller9=false;this.$PresencePollerf();this.$PresencePoller7=Date.now();s.update(ha.time);if(ia.mobile_friends)this.$PresencePoller8=Date.now();this.$PresencePollera=0;this.$PresencePollerg();var ja=ia.userInfos;if(ja)t.setMulti(ja);var ka=ia.chatContexts;ka&&k.update(ka);this.$PresencePoller1=ia.userIsIdle;if(ia.chatNotif!==undefined){this.$PresencePoller2=ia.chatNotif;this.$PresencePoller0(g.ON_CHAT_NOTIFICATION_CHANGED,this.$PresencePoller2);}this.$PresencePollerb('buddy_list_poller',ha.time,ia.nowAvailableList,ia.last_active_times,ia.mobile_friends,ia.todays_birthdays);};fa.prototype.$PresencePollere=function(ga){i.bumpEntityKey(ea,'error');if(ga.getError()==1356007)return;this.$PresencePoller9=false;this.$PresencePollera++;if(this.$PresencePollera++>=x)this.$PresencePoller0(g.ON_UPDATE_ERROR);};fa.prototype.$PresencePollerg=function(){var ga=u.isActive(ca)?aa:ba;i.bumpEntityKey(ea,'period.'+ga);this.$PresencePoller3.setInterval(ga);};fa.prototype.$PresencePollerf=function(){var ga=Date.now(),ha=ga-this.$PresencePoller7;da.log('buddylist_presence_stats',v({duration:ha},r.getPresenceStats()));};e.exports=fa;});
__d("AvailableList",["function-extensions","Arbiter","ArbiterMixin","AsyncRequest","AvailableListConstants","ChannelImplementation","ChannelConstants","ChatConfig","ChatFavoriteList","JSLogger","PresencePoller","PresencePrivacy","PresenceStatus","ShortProfiles","TypingDetector","copyProperties","debounceAcrossTransitions","emptyFunction"],function(a,b,c,d,e,f){b('function-extensions');var g=b('Arbiter'),h=b('ArbiterMixin'),i=b('AsyncRequest'),j=b('AvailableListConstants'),k=b('ChannelImplementation').instance,l=b('ChannelConstants'),m=b('ChatConfig'),n=b('ChatFavoriteList'),o=b('JSLogger'),p=b('PresencePoller'),q=b('PresencePrivacy'),r=b('PresenceStatus'),s=b('ShortProfiles'),t=b('TypingDetector'),u=b('copyProperties'),v=b('debounceAcrossTransitions'),w=b('emptyFunction'),x=u({},j,h);x.subscribe([j.ON_AVAILABILITY_CHANGED,j.ON_UPDATE_ERROR],function(ea,fa){g.inform(ea,fa);});var y=v(function(){x.inform(j.ON_AVAILABILITY_CHANGED);},0);function z(ea,fa,ga,ha){var ia=r.set(ea,fa,ga,ha);if(ia)y();}function aa(ea){var fa=ea.payload.availability||{};for(var ga in fa)z(ga,fa[ga],true,'mercury_tabs');}function ba(ea){var fa=x.getDebugInfo(ea),ga=(fa.presence==j.ACTIVE),ha=new i('/ajax/mercury/tabs_presence.php').setData({target_id:ea,to_online:ga,presence_source:fa.overlaySource,presence_time:fa.overlayTime}).setHandler(aa).setErrorHandler(w).setAllowCrossPageTransition(true).send();}function ca(ea,fa){fa.chat_config=m.getDebugInfo();fa.available_list_debug_info={};x.getAvailableIDs().forEach(function(ga){fa.available_list_debug_info[ga]=x.getDebugInfo(ga);});fa.available_list_poll_interval=x._poller&&x._poller.getInterval();}var da=new p(function(event){x.inform(event);});u(x,{get:function(ea){return r.get(ea);},updateForID:function(ea){ba(ea);},getWebChatNotification:function(){return da.getWebChatNotification();},isUserIdle:function(){return da.getIsUserIdle();},isReady:function(){return true;},set:function(ea,fa,ga){z(ea,fa,true,ga);},update:function(){da.forceUpdate();},isIdle:function(ea){return x.get(ea)==j.IDLE;},getOnlineIDs:function(){return r.getOnlineIDs();},getAvailableIDs:function(){return r.getAvailableIDs();},getOnlineCount:function(){return r.getOnlineCount();},getDebugInfo:function(ea){var fa=r.getDebugInfo(ea),ga=s.getNow(ea);if(ga)fa.name=ga.name;return fa;}});da.start();g.subscribe(o.DUMP_EVENT,ca);g.subscribe(l.getArbiterType('favorite_list'),function(ea,fa){var ga=fa.obj,ha=ga.value?ga.value.split(','):[];n.init(ha);y();});q.subscribe(['privacy-changed','privacy-availability-changed','privacy-user-presence-response'],y);k.subscribe([k.CONNECTED,k.RECONNECTING,k.SHUTDOWN,k.MUTE_WARNING,k.UNMUTE_WARNING],y);g.subscribe(l.getArbiterType('buddylist_overlay'),function(ea,fa){var ga=fa.obj.overlay;for(var ha in ga)x.set(ha,ga[ha].a,ga[ha].s||'channel');});g.subscribe([l.getArbiterType('typ'),l.getArbiterType('ttyp')],function(ea,fa){var ga=fa.obj;if(ga.st===t.TYPING){var ha=ga.from;x.set(ha,j.ACTIVE,'channel-typing');}});a.AvailableList=e.exports=x;});
__d("ContextualDialogFooterLink",["CSS","DOM","Event","copyProperties"],function(a,b,c,d,e,f){var g=b('CSS'),h=b('DOM'),i=b('Event'),j=b('copyProperties');function k(l){this._layer=l;}k.prototype.enable=function(){var l=this._layer.getRoot(),m=h.scry(l,'.uiContextualDialogFooterLink')[0],n='uiContextualDialogHoverFooterArrow';this._subscriptions=[i.listen(m,'mouseenter',g.addClass.curry(l,n)),i.listen(m,'mouseleave',g.removeClass.curry(l,n))];};k.prototype.disable=function(){this._subscriptions.forEach(function(l){l.remove();});this._subscriptions=null;};j(k.prototype,{_subscriptions:null});e.exports=k;});
__d("LayerHideOnSuccess",["copyProperties"],function(a,b,c,d,e,f){var g=b('copyProperties');function h(i){this._layer=i;}h.prototype.enable=function(){this._subscription=this._layer.subscribe('success',this._layer.hide.bind(this._layer));};h.prototype.disable=function(){if(this._subscription){this._subscription.unsubscribe();this._subscription=null;}};g(h.prototype,{_subscription:null});e.exports=h;});
__d("Overlay",["CSS","DataStore","DOM","Layer","LayerButtons","LayerDestroyOnHide","LayerFadeOnHide","LayerFadeOnShow","LayerFormHooks","LayerHideOnBlur","LayerHideOnEscape","LayerHideOnSuccess","LayerHideOnTransition","LayerMouseHooks","LayerTabIsolation","copyProperties"],function(a,b,c,d,e,f){var g=b('CSS'),h=b('DataStore'),i=b('DOM'),j=b('Layer'),k=b('LayerButtons'),l=b('LayerDestroyOnHide'),m=b('LayerFadeOnHide'),n=b('LayerFadeOnShow'),o=b('LayerFormHooks'),p=b('LayerHideOnBlur'),q=b('LayerHideOnEscape'),r=b('LayerHideOnSuccess'),s=b('LayerHideOnTransition'),t=b('LayerMouseHooks'),u=b('LayerTabIsolation'),v=b('copyProperties');for(var w in j)if(j.hasOwnProperty(w))y[w]=j[w];var x=j===null?null:j.prototype;y.prototype=Object.create(x);y.prototype.constructor=y;y.__superConstructor__=j;function y(z,aa){z=v({buildWrapper:true},z||{});this._shouldBuildWrapper=z.buildWrapper;j.call(this,z,aa);}y.prototype._configure=function(z,aa){x._configure.call(this,z,aa);var ba=this.getRoot();this._overlay=i.scry(ba,'div.uiOverlay')[0]||ba;g.hide(ba);i.appendContent(this.getInsertParent(),ba);h.set(this._overlay,'overlay',this);var ca=h.get(this._overlay,'width');ca&&this.setWidth(ca);if(this.setFixed)this.setFixed(h.get(this._overlay,'fixed')=='true');if(h.get(this._overlay,'fadeonshow')!='false')this.enableBehavior(n);if(h.get(this._overlay,'fadeonhide')!='false')this.enableBehavior(m);if(h.get(this._overlay,'hideonsuccess')!='false')this.enableBehavior(r);if(h.get(this._overlay,'hideonblur')=='true')this.enableBehavior(p);if(h.get(this._overlay,'destroyonhide')!='false')this.enableBehavior(l);return this;};y.prototype._getDefaultBehaviors=function(){return x._getDefaultBehaviors.call(this).concat([k,o,t,q,s,u]);};y.prototype.initWithoutBuildingWrapper=function(){this._shouldBuildWrapper=false;return this.init.apply(this,arguments);};y.prototype._buildWrapper=function(z,aa){aa=x._buildWrapper.call(this,z,aa);if(!this._shouldBuildWrapper){this._contentRoot=aa;return aa;}this._contentRoot=i.create('div',{className:'uiOverlayContent'},aa);return i.create('div',{className:'uiOverlay'},this._contentRoot);};y.prototype.getContentRoot=function(){return this._contentRoot;};y.prototype.destroy=function(){h.remove(this.getRoot(),'overlay');x.destroy.call(this);};e.exports=y;});
__d("LegacyContextualDialog",["Arbiter","ArbiterMixin","ARIA","Bootloader","ContextualDialogFooterLink","ContextualThing","CSS","DataStore","DOM","Event","LayerAutoFocus","LayerRefocusOnHide","Locale","Overlay","Parent","Style","Vector","$","copyProperties","getOverlayZIndex","shield"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('ArbiterMixin'),i=b('ARIA'),j=b('Bootloader'),k=b('ContextualDialogFooterLink'),l=b('ContextualThing'),m=b('CSS'),n=b('DataStore'),o=b('DOM'),p=b('Event'),q=b('LayerAutoFocus'),r=b('LayerRefocusOnHide'),s=b('Locale'),t=b('Overlay'),u=b('Parent'),v=b('Style'),w=b('Vector'),x=b('$'),y=b('copyProperties'),z=b('getOverlayZIndex'),aa=b('shield');for(var ba in t)if(t.hasOwnProperty(ba))da[ba]=t[ba];var ca=t===null?null:t.prototype;da.prototype=Object.create(ca);da.prototype.constructor=da;da.__superConstructor__=t;function da(){if(t!==null)t.apply(this,arguments);}da.prototype._configure=function(ea,fa){ca._configure.call(this,ea,fa);var ga=this.getRoot(),ha=n.get.curry(ga);this.setAlignH(ha('alignh','left'));this.setOffsetX(ha('offsetx',0));this.setOffsetY(ha('offsety',0));this.setPosition(ha('position','above'));this._hasFooter=ha('hasfooter',false);if(this._hasFooter){var ia=o.scry(ga,'.uiContextualDialogFooterLink')[0];ia&&this.enableBehavior(k);}this.enableBehaviors(this._getDefaultBehaviors());this._setContextSubscription=this.subscribe('beforeshow',function(){this.unsubscribe(this._setContextSubscription);this._setContextSubscription=null;var ka=ha('context');if(ka){this.setContext(x(ka));}else{ka=ha('contextselector');if(ka)this.setContext(o.find(document,ka));}}.bind(this));this._content=o.scry(ga,'.uiContextualDialogContent')[0];if(this._content){this._content.setAttribute('role','dialog');var ja=o.scry(this._content,'.legacyContextualDialogTitle')[0];if(ja)this._content.setAttribute('aria-labelledby',o.getID(ja));}this._showSubscription=this.subscribe('show',function(){var ka=aa(this.updatePosition,this);this._resizeListener=p.listen(window,'resize',ka);this._reflowSubscription=g.subscribe('reflow',ka);this._setupScrollListener(this._scrollParent);l.register(ga,this.context);g.inform('layer_shown',{type:'ContextualDialog'});}.bind(this));this._hideSubscription=this.subscribe('hide',function(){this._teardownResizeAndReflowListeners();this._teardownScrollListener();g.inform('layer_hidden',{type:'ContextualDialog'});}.bind(this));return this;};da.prototype._getDefaultBehaviors=function(){return ca._getDefaultBehaviors.call(this).concat([q,r]);};da.prototype._buildWrapper=function(ea,fa){var ga=ca._buildWrapper.call(this,ea,fa);if(!this._shouldBuildWrapper)return ga;m.addClass(ga,'uiContextualDialog');return o.create('div',{className:'uiContextualDialogPositioner'},ga);};da.prototype.setWidth=function(ea){this._width=Math.floor(ea);return this;};da.prototype.setFixed=function(ea){ea=!!ea;m.conditionClass(this.getRoot(),'uiContextualDialogFixed',ea);this._fixed=ea;return this;};da.prototype.setAlignH=function(ea){this.alignH=ea;this._updateAlignmentClass();this._shown&&this.updatePosition();this.position&&this._updateArrow();return this;};da.prototype.getContent=function(){return this._content;};da.prototype.getContext=function(){return this.context;};da.prototype.setContext=function(ea){if(this._setContextSubscription){this.unsubscribe(this._setContextSubscription);this._setContextSubscription=null;}ea=x(ea);if(this.context&&this.context!=ea)n.remove(this.context,'LegacyContextualDialog');this.context=ea;i.setPopup(this.getCausalElement(),this.getRoot());var fa=u.byClass(ea,'fbPhotoSnowlift');this.setInsertParent(fa||document.body);if(this._scrollListener&&this._scrollParent!==fa){this._teardownScrollListener();this._setupScrollListener(fa);}this._scrollParent=fa;var ga=z(ea,this._insertParent);v.set(this.getRoot(),'z-index',ga>200?ga:'');n.set(this.context,'LegacyContextualDialog',this);return this;};da.prototype.getCausalElement=function(){return ca.getCausalElement.call(this)||this.context;};da.prototype.listen=function(ea,fa){return p.listen(this.getRoot(),ea,fa);};da.prototype.setOffsetX=function(ea){this.offsetX=parseInt(ea,10)||0;this._shown&&this.updatePosition();return this;};da.prototype.setOffsetY=function(ea){this.offsetY=parseInt(ea,10)||0;this._shown&&this.updatePosition();return this;};da.prototype.setPosition=function(ea){this.position=ea;for(var fa in da.POSITION_TO_CLASS)m.conditionClass(this.getRoot(),da.POSITION_TO_CLASS[fa],ea==fa);this._updateAlignmentClass();this._shown&&this.updatePosition();this._updateArrow();return this;};da.prototype.updatePosition=function(){if(!this.context)return false;if(this._width)v.set(this._overlay,'width',this._width+'px');var ea=this._fixed?'viewport':'document',fa=w.getElementPosition(this.context,ea),ga=this._scrollParent;if(ga)fa=fa.sub(w.getElementPosition(ga,'document')).add(ga.scrollLeft,ga.scrollTop);var ha=w.getElementDimensions(this.context),ia=this.position=='above'||this.position=='below',ja=s.isRTL();if((this.position=='right'||(ia&&this.alignH=='right'))!=ja)fa=fa.add(ha.x,0);if(this.position=='below')fa=fa.add(0,ha.y);var ka=new w(0,0);if(ia&&this.alignH=='center'){ka=ka.add((ha.x-this._width)/2,0);}else{var la=ia?ha.x:ha.y,ma=2*da.ARROW_INSET;if(la<ma){var na=la/2-da.ARROW_INSET;if(ia&&(this.alignH=='right'!=ja))na=-na;ka=ka.add(ia?na:0,ia?0:na);}}ka=ka.add(this.offsetX,this.offsetY);if(ja)ka=ka.mul(-1,1);fa=fa.add(ka);if(this._fixed)fa=new w(fa.x,fa.y,'document');fa.setElementPosition(this.getRoot());this._adjustVerticalPosition();this._adjustHorizontalPosition();return true;};da.prototype.scrollTo=function(){if(this.context)j.loadModules(['DOMScroll'],function(ea){ea.scrollTo(this.context,true,true);}.bind(this));};da.prototype.destroy=function(){this.unsubscribe(this._showSubscription);this.unsubscribe(this._hideSubscription);if(this._setContextSubscription){this.unsubscribe(this._setContextSubscription);this._setContextSubscription=null;}this._teardownScrollListener();this._teardownResizeAndReflowListeners();this.context&&n.remove(this.context,'LegacyContextualDialog');ca.destroy.call(this);};da.prototype._adjustVerticalPosition=function(){if(this.position!='left'&&this.position!='right'){v.set(this._overlay,'top','');return;}var ea=this.getRoot(),fa=w.getElementPosition(ea,'viewport').y,ga=w.getElementDimensions(this._overlay).y,ha=w.getViewportDimensions().y,ia=Math.min(Math.max(fa,da.MIN_TOP_GAP),da.TOP_MARGIN),ja=Math.min(Math.max(0,fa+ga+da.BOTTOM_MARGIN-ha),Math.max(-ia,fa-ia),ga-2*da.ARROW_INSET);v.set(this._overlay,'top',(-1*ja)+'px');v.set(this._arrow,'top',da.ARROW_OFFSET+'px');v.set(this._arrow,'marginTop',ja+'px');};da.prototype._adjustHorizontalPosition=function(){if((this.position!='above'&&this.position!='below')||this.alignH!='left'){v.set(this._overlay,'left','');v.set(this._overlay,'right','');return;}var ea=this.getRoot(),fa=w.getElementPosition(ea,'viewport').x,ga=w.getElementDimensions(this._overlay).x,ha=w.getViewportDimensions().x,ia=s.isRTL(),ja;if(!ia){ja=fa+ga+da.RIGHT_MARGIN-ha;}else ja=da.LEFT_MARGIN+ga-fa;ja=Math.min(Math.max(0,ja),ga-2*da.ARROW_INSET);v.set(this._overlay,ia?'right':'left',-1*ja+'px');v.set(this._arrow,ia?'right':'left',da.ARROW_OFFSET+'px');v.set(this._arrow,ia?'marginRight':'marginLeft',ja+'px');};da.prototype._updateArrow=function(){var ea=0;if(this.position=='above'||this.position=='below')switch(this.alignH){case 'center':ea=50;break;case 'right':ea=100;break;}this._renderArrow(da.POSITION_TO_ARROW[this.position],ea);};da.prototype._renderArrow=function(ea,fa){for(var ga in da.ARROW_CLASS)m.conditionClass(this._overlay,da.ARROW_CLASS[ga],ea==ga);m.conditionClass(this._overlay,'uiContextualDialogWithFooterArrowBottom',ea=='bottom'&&this._hasFooter);if(ea=='none')return;if(!this._arrow){this._arrow=o.create('i',{className:'uiContextualDialogArrow'});o.appendContent(this._overlay,this._arrow);}v.set(this._arrow,'top','');v.set(this._arrow,'left','');v.set(this._arrow,'right','');v.set(this._arrow,'margin','');var ha=ea=='top'||ea=='bottom',ia=ha?(s.isRTL()?'right':'left'):'top';fa=fa||0;v.set(this._arrow,ia,fa+'%');var ja=da.ARROW_LENGTH+da.ARROW_OFFSET*2,ka=-(ja*fa/100-da.ARROW_OFFSET);v.set(this._arrow,'margin-'+ia,ka+'px');};da.prototype._updateAlignmentClass=function(){m.conditionClass(this.getRoot(),da.RIGHT_ALIGNED_CLASS,(this.position=='above'||this.position=='below')&&this.alignH=='right');};da.prototype._setupScrollListener=function(ea){this._scrollListener=p.listen(ea||window,'scroll',aa(this._adjustVerticalPosition,this));};da.prototype._teardownScrollListener=function(){if(this._scrollListener){this._scrollListener.remove();this._scrollListener=null;}};da.prototype._teardownResizeAndReflowListeners=function(){if(this._resizeListener){this._resizeListener.remove();this._resizeListener=null;}if(this._reflowSubscription){this._reflowSubscription.unsubscribe();this._reflowSubscription=null;}};da.getInstance=function(ea){var fa=n.get(ea,'LegacyContextualDialog');if(!fa){var ga=u.byClass(ea,'uiOverlay');if(ga)fa=n.get(ga,'overlay');}return fa;};y(da,h,{ARROW_OFFSET:15,ARROW_LENGTH:16,ARROW_INSET:22,TOP_MARGIN:50,BOTTOM_MARGIN:30,LEFT_MARGIN:15,RIGHT_MARGIN:30,MIN_TOP_GAP:5,POSITION_TO_CLASS:{above:'uiContextualDialogAbove',below:'uiContextualDialogBelow',left:'uiContextualDialogLeft',right:'uiContextualDialogRight'},RIGHT_ALIGNED_CLASS:'uiContextualDialogRightAligned',ARROW_CLASS:{bottom:'uiContextualDialogArrowBottom',top:'uiContextualDialogArrowTop',right:'uiContextualDialogArrowRight',left:'uiContextualDialogArrowLeft'},POSITION_TO_ARROW:{above:'bottom',below:'top',left:'right',right:'left'}});y(da.prototype,{_scrollListener:null,_scrollParent:null,_width:null,_fixed:false,_hasFooter:false,_showSubscription:null,_hideSubscription:null,_setContextSubscription:null,_resizeListener:null,_reflowSubscription:null});e.exports=da;});
__d("BlackbirdUpsell",["Event","Arbiter","AsyncRequest","LegacyContextualDialog","DOM","LayerDestroyOnHide","LayerHideOnTransition","PresencePrivacy","copyProperties","BlackbirdUpsellConfig","BlackbirdUpsellConstants","BlackbirdUpsellTemplates"],function(a,b,c,d,e,f){var g=b('Event'),h=b('Arbiter'),i=b('AsyncRequest'),j=b('LegacyContextualDialog'),k=b('DOM'),l=b('LayerDestroyOnHide'),m=b('LayerHideOnTransition'),n=b('PresencePrivacy'),o=b('copyProperties'),p=b('BlackbirdUpsellConfig'),q=b('BlackbirdUpsellConstants'),r=b('BlackbirdUpsellTemplates'),s='/ajax/chat/blackbird/update_clicks.php',t='/ajax/chat/blackbird/update_impressions.php',u='/ajax/chat/blackbird/dismiss.php',v=235,w=null,x=null,y=false,z=false;function aa(){}o(aa,{shouldShow:function(){if(this._dialogDismissed)return false;if(this.isEducation()){return !p.EducationDismissed&&p.EducationImpressions<p.EducationImpressionLimit;}else return !!p.UpsellGK&&!p.UpsellDismissed&&p.UpsellImpressions<p.UpsellImpressionLimit&&p.FriendCount>=p.UpsellMinFriendCount;},isEducation:function(){return p.TimeOffline<=p.EducationTimeOfflineThresdhold;},getOfflineContent:function(){if(this.isEducation()){return this._getEducationContent();}else return this._getUpsellContent();},_getEducationContent:function(){ga();var ka=r[':fb:chat:blackbird:offline-educate'].build(),la=ka.getNode('chatSettingsButton');g.listen(la,'click',function(){h.inform('chat/advanced-settings-dialog-opened');ja(q.CLICK_TYPE_OPEN_SETTINGS);da();});return ka.getRoot();},_getUpsellContent:function(){fa();var ka=r[':fb:chat:blackbird:upsell'].build(),la=ka.getNode('chatSettingsButton');g.listen(la,'click',function(){h.inform('chat/advanced-settings-dialog-opened');ia(q.CLICK_TYPE_OPEN_SETTINGS);ca();});var ma=ka.getNode('enableChatButton');g.listen(ma,'click',function(){ia(q.CLICK_TYPE_ENABLE_CHAT);ca();});return ka.getRoot();},getBlackbirdContent:function(ka){ga();switch(ka){case n.ONLINE:return r[':fb:chat:blackbird:most-friends-educate'].build().getRoot();case n.OFFLINE:return r[':fb:chat:blackbird:some-friends-educate'].build().getRoot();}},showOfflineDialog:function(ka){this.showDialog(ka,this.getOfflineContent.bind(this));},showBlackbirdDialog:function(ka,la){this.showDialog(ka,this.getBlackbirdContent.curry(la));},showDialog:function(ka,la){!w&&this._constructDialog();k.setContent(x,la());w.setContext(ka);w.show();},hide:function(){if(w&&w.isShown())w.hide();},dismiss:function(){this.hide();if(this.isEducation()){da();}else ca();},registerDismissClick:function(){if(this.isEducation()){ja(q.CLICK_TYPE_DISMISS_PROMO);}else ia(q.CLICK_TYPE_DISMISS_PROMO);},isVisible:function(){return z&&!y;},_constructDialog:function(){var ka=r[':fb:chat:blackbird:dialog-frame'].build();x=ka.getNode('dialogContent');w=new j();w.init(ka.getRoot());w.setPosition('above').setWidth(v).setFixed(true).disableBehavior(l).disableBehavior(m);g.listen(ka.getNode('dialogCloseButton'),'click',this.dismiss.bind(this));g.listen(ka.getNode('dialogCloseButton'),'click',this.registerDismissClick.bind(this));}});function ba(ka,la){if(!y&&z){y=true;n.inform('privacy-user-presence-changed');var ma=new i(u);ma.setData({source:ka,impressions:la,time_offline:p.TimeOffline});ma.setErrorHandler(function(){y=false;});ma.send();}}function ca(){ba(q.ACTION_UPSELL,p.UpsellImpressions);}function da(){ba(q.ACTION_EDUCATE,p.EducationImpressions);}function ea(ka,la){if(!z){z=true;var ma=new i(t);ma.setData({action:ka,impressions:la,time_offline:p.TimeOffline});ma.setErrorHandler(function(){z=false;});ma.send();}}function fa(){ea(q.ACTION_UPSELL,p.UpsellImpressions);}function ga(){ea(q.ACTION_EDUCATE,p.EducationImpressions);}function ha(ka,la,ma,na){var oa=new i(s);oa.setData({action:ka,impressions:ma,source:la,time_offline:na});oa.send();}function ia(ka){ha(ka,q.ACTION_UPSELL,p.UpsellImpressions,p.TimeOffline);}function ja(ka){ha(ka,q.ACTION_EDUCATE,p.EducateImpressions,p.TimeOffline);}h.subscribe('chat/advanced-settings-dialog-opened',aa.dismiss.bind(aa));h.subscribe('chat-visibility/go-online',aa.dismiss.bind(aa));h.subscribe('chat-visibility/go-offline',aa.dismiss.bind(aa));e.exports=aa;});
__d("ChatTypeaheadConstants",[],function(a,b,c,d,e,f){var g={USER_TYPE:'user',THREAD_TYPE:'thread',FRIEND_TYPE:'friend',NON_FRIEND_TYPE:'non_friend',FB4C_TYPE:'fb4c',HEADER_TYPE:'header'};e.exports=g;});
__d("Chat",["Arbiter","ChatTypeaheadConstants","MercuryParticipantTypes"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('ChatTypeaheadConstants'),i=b('MercuryParticipantTypes');function j(o,p){d(['ChatImpressionLogger','PresenceStatus'],function(q,r){var s=p&&p.source;if(s&&s==='ordered_list'||s==='more_online_friends'||s==='online_friends'||s==='recent_threads_in_divebar_new'||s==='recent_threads_in_divebar'||s==='presence'||s==='typeahead'){p.viewport_width=document.body.clientWidth;p.target=o;p.target_presence=r.get(o);q.logImpressions(p);}});}var k={buddyListNub:'buddylist-nub/initialized',sidebar:'sidebar/initialized'};function l(o,p){g.subscribe(k[o],function(event,q){p(q);});}function m(){return (Math.random()*2147483648|0).toString(16);}var n={openTab:function(o,p,q){if(window.External&&window.External.Chat&&window.External.Chat.openWindow)window.External.Chat.openWindow(o);j.curry(o,q).defer();d(['MercuryThreads'],function(r){if(!p||p===i.FRIEND||p===h.FRIEND_TYPE||p===h.USER_TYPE){var s=r.get().getCanonicalThreadToUser(o),t=m();g.inform('chat/open-tab',{thread_id:s.thread_id,signature_id:t});return;}if(p===h.THREAD_TYPE)d(['ChatOpenTab'],function(u){if(o){u.openThread(o);}else u.openEmptyTab();});});},openBuddyList:function(){l('buddyListNub',function(o){o.show();l('sidebar',function(p){p.enable();});});},closeBuddyList:function(){l('buddyListNub',function(o){o.hide();});},toggleSidebar:function(){l('sidebar',function(o){o.toggle();});},goOnline:function(o){d(['ChatVisibility'],function(p){p.goOnline(o);});},isOnline:function(){var o=null;d(['ChatVisibility'],function(p){o=p;});return o&&o.isOnline();}};a.Chat=e.exports=n;},3);
__d("ChatFavoriteNux",["AsyncRequest"],function(a,b,c,d,e,f){var g=b('AsyncRequest'),h=null,i=false,j={tryShow:function(k){if(h&&!i){h.setContext(k);h.show();i=true;}},tryHide:function(){if(h&&i){h.hide();h=null;}},registerDialog:function(k){h=k;if(k)k.subscribe('confirm',this.dismissDialog);},dismissDialog:function(){if(h){new g('/ajax/chat/dismiss_favorite_nux.php').send();h.hide();h=null;}}};e.exports=j;});
__d("ChatHovercard",["Arbiter","AsyncLoader","Hovercard","JSLogger","debounce"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('AsyncLoader'),i=b('Hovercard'),j=b('JSLogger'),k=b('debounce'),l=5,m=new h('/ajax/chat/hovercard/sidebar.php','hover'),n=j.create('chat_hovercard');g.subscribe('Hovercard/dirty',m.reset.bind(m));function o(s,t){m.get(s,function(u){(function(){if(!u){n.error('fetch_failure',{id:s});return;}var v=i.getDialog(u);if(!v){n.error('no_hovercard',{id:s,endpoint:u});return;}if(s==t.getActiveID())t.showHovercard(s,v);}).defer();});}function p(s,t){var u=[];function v(y){if(y>=0&&y<s.length)u.push(s[y]);}var w=s.indexOf(t);if(w>-1){v(w);for(var x=1;x<l;x++){v(w+x);v(w-x);}}return u.filter(function(y){return y;});}function q(s,t){var u=t.getActiveID();if(u){var v=s.getShowingUsers(),w=p(v,u);m.get(w,function(){});}}function r(s){var t=s.getHoverController();t.registerDefault(o);t.subscribe('hover',k(q.curry(s,t),100));}e.exports=r;});
__d("ChatImpressionLogger",["AvailableList","AsyncSignal","ChatConfig","ChatVisibility","Poller"],function(a,b,c,d,e,f){var g=b('AvailableList'),h=b('AsyncSignal'),i=b('ChatConfig'),j=b('ChatVisibility'),k=b('Poller'),l=null,m=null,n={init:function(o){l=o;var p=i.get('chat_impression_logging_periodical',0);if(p){var q=i.get('periodical_impression_logging_config.interval');m=new k({interval:q,setupRequest:this.logImps.bind(this),clearOnQuicklingEvents:false});}this.init=function(){};},logImps:function(o){if(!j.isOnline())return;var p={source:'periodical_imps'},q=l.getCachedSortedList(),r=[];for(var s=0;s<q.length;s++)r[s]=g.get(q[s]);p.sorted_list=q.toString();p.list_availability=r.toString();o.setURI('/ajax/chat/imps_logging.php').setData(p);},getOrderedList:function(){return l;},logImpressions:function(o){var p=[],q=[];if(i.get('chat_impression_logging_with_click')){p=l.getCachedSortedList();for(var r=0;r<p.length;r++)q[r]=g.get(p[r]);}o.sorted_list=p.toString();o.list_availability=q.toString();new h('/ajax/chat/ct.php',o).send();}};e.exports=n;});
__d("ChatOptions",["Arbiter","ChannelConstants","JSLogger","PresenceUtil","copyProperties","ChatOptionsInitialData"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('ChannelConstants'),i=b('JSLogger'),j=b('PresenceUtil'),k=b('copyProperties'),l=i.create('chat_options'),m={};(function(){var o=b('ChatOptionsInitialData');for(var p in o){var q=o[p];m[p]=!!q;}})();var n=k(new g(),{getSetting:function(o){return m[o];},setSetting:function(o,p,q){if(this.getSetting(o)==p)return;if(q){q='from_'+q;l.log(q,{name:o,new_value:p,old_value:this.getSetting(o)});}m[o]=!!p;g.inform('chat/option-changed',{name:o,value:p});}});g.subscribe(h.getArbiterType('setting'),function(o,p){var q=p.obj;if(q.window_id===j.getSessionID())return;n.setSetting(q.setting,!!q.value,'channel');});g.subscribe(i.DUMP_EVENT,function(o,p){p.chat_options=m;});e.exports=n;});
__d("ChatOrderedListHover",["function-extensions","ArbiterMixin","ChatFavoriteList","CSS","ErrorUtils","Event","LayerHideOnBlur","Parent","copyProperties","cx","mixin","setTimeoutAcrossTransitions","shield"],function(a,b,c,d,e,f){b('function-extensions');var g=b('ArbiterMixin'),h=b('ChatFavoriteList'),i=b('CSS'),j=b('ErrorUtils'),k=b('Event'),l=b('LayerHideOnBlur'),m=b('Parent'),n=b('copyProperties'),o=b('cx'),p=b('mixin'),q=b('setTimeoutAcrossTransitions'),r=b('shield');function s(y){i.addClass(y,'fetching');}function t(y){i.removeClass(y,'fetching');}var u=p(g);for(var v in u)if(u.hasOwnProperty(v))x[v]=u[v];var w=u===null?null:u.prototype;x.prototype=Object.create(w);x.prototype.constructor=x;x.__superConstructor__=u;function x(y){this._orderedList=y;this._root=y.getRoot();k.listen(this._root,'mouseover',this._mouseOver.bind(this));k.listen(this._root,'mouseleave',this._mouseLeave.bind(this));y.subscribe('click',r(this._hide,this));}x.prototype._mouseOver=function(event){if(this._paused)return;var y=event.getTarget(),z=m.byClass(y,"_42fz")||m.byClass(y,"_5a58");z&&this._setActiveItem(z);};x.prototype._mouseLeave=function(event){this._setActiveItem(null);};x.prototype._clearTimeouts=function(){this._showTimeout&&clearTimeout(this._showTimeout);this._showTimeout=null;this._hideTimeout&&clearTimeout(this._hideTimeout);this._hideTimeout=null;};x.prototype._hide=function(){if(this._showingDialog){this._showingDialog.hide();this._showingDialog=null;this._showingID=null;}};x.prototype._show=function(){var y=this.getActiveID(),z=false;if(this._handlers[y]){z=true;j.applyWithGuard(this._handlers[y],{},[y,this]);}else if(this._defaultHandler){z=true;j.applyWithGuard(this._defaultHandler,{},[y,this]);}if(z&&this._showingID!=this.getActiveID())s(this._activeItem);};x.prototype._setActiveItem=function(y){if(h.isEditMode()){this._clearTimeouts();this._hide();return;}if(y!=this._activeItem){this._clearTimeouts();this._activeItem&&t(this._activeItem);this._activeItem=null;var z=y?0:100;this._hideTimeout=q(function(){if(this.getActiveID()!=this._showingID)this._hide();}.bind(this),z);if(y){this._activeItem=y;var aa=z+500;this._showTimeout=q(function(){this._show();}.bind(this),aa);this.inform('hover');}else this.inform('leave');}};x.prototype.register=function(y,z){if(!this._handlers[y]){this._handlers[y]=z;return {unregister:function(){if(y==this._showingID)this._hide();delete this._handlers[y];var aa=this._orderedList.getAllNodes(),ba=aa[y];ba&&t(ba);}.bind(this)};}};x.prototype.registerDefault=function(y){this._defaultHandler=y;};x.prototype.getActiveID=function(){var y=this._activeItem&&this._orderedList.getUserForNode(this._activeItem);return y||null;};x.prototype.showHovercard=function(y,z){if(y==this.getActiveID()&&y!=this._showingID){this._clearTimeouts();t(this._activeItem);this._hide();this._showingDialog=z;this._showingID=y;var aa=z.subscribe('mouseenter',this._setActiveItem.bind(this,this._activeItem)),ba=z.subscribe('mouseleave',function(){aa.unsubscribe();this._setActiveItem(null);}.bind(this)),ca=z.subscribe('hide',function(){this.inform('hovercard_hide');aa.unsubscribe();ba.unsubscribe();ca.unsubscribe();}.bind(this));z.enableBehavior(l).setContext(this._activeItem).setPosition('left').show();this.inform('hovercard_show');}};x.prototype.setPaused=function(y){this._paused=y;};n(x.prototype,{_root:null,_activeItem:null,_hideTimeout:null,_showTimeout:null,_showingDialog:null,_showingID:null,_handlers:{},_defaultHandler:null});e.exports=x;});
__d("ChatQuietLinks",["Event","DOM","UserAgent","DataStore","Parent"],function(a,b,c,d,e,f){var g=b('Event'),h=b('DOM'),i=b('UserAgent'),j=b('DataStore'),k=b('Parent'),l={},m={silenceLinks:function(q){n(q,this.removeEmptyHrefs.bind(this));},nukeLinks:function(q){n(q,this.removeAllHrefs.bind(this));},removeEmptyHrefs:function(q){o(q,function(r){return !r||r==='#';});},removeAllHrefs:function(q){o(q);},removeMessagesHrefs:function(q){o(q,function(r){return !r||r==='#'||r.indexOf('/messages/')!=-1;});}};function n(q,r){var s=!!i.chrome(),t=!!i.chrome()||i.ie()>=9||i.firefox()>=4;if(l[h.getID(q)])return;l[h.getID(q)]=true;if(!t)return;if(!s){r&&r(q);return;}g.listen(q,'mouseover',function u(v){var w=k.byTag(v.getTarget(),'a');if(w){var x=w.getAttribute('href');if(p(x)){j.set(w,'stashedHref',w.getAttribute('href'));w.removeAttribute('href');}}});g.listen(q,'mouseout',function u(v){var w=k.byTag(v.getTarget(),'a'),x=w&&j.remove(w,'stashedHref');if(p(x))w.setAttribute('href',x);});g.listen(q,'mousedown',function(u){if(!u.isDefaultRequested())return true;var v=k.byTag(u.getTarget(),'a'),w=v&&j.get(v,'stashedHref');if(p(w))v.setAttribute('href',w);});}function o(q,r){var s=h.scry(q,'a');if(r)s=s.filter(function(t){return r(t.getAttribute('href'));});s.forEach(function(t){t.removeAttribute('href');t.setAttribute('tabindex',0);});}function p(q){return q&&q!=='#';}e.exports=m;});
__d("ChatSidebarConstants",[],function(a,b,c,d,e,f){var g={LITESTAND_IMAGE_SIZE:24,LITESTAND_BLENDED_SIZE:32,IMAGE_SIZE:28};e.exports=g;});
__d("ChatSidebarThread.react",["ChatSidebarItem.react","WebMessengerPermalinkConstants","React","MercuryThreadMetadataRawRenderer"],function(a,b,c,d,e,f){var g=b('ChatSidebarItem.react'),h=b('WebMessengerPermalinkConstants'),i=b('React'),j=b('MercuryThreadMetadataRawRenderer'),k=i.createClass({displayName:'ChatSidebarThread',render:function(){var n=this.props.name,o=l(this.props.threadID,this.props.participants),p=n?o:undefined,q=h.getURIPathForThreadID(this.props.threadID),r=m(this.props.image,this.props.participants),s=n?n:o;return (g({context:p,href:{url:q},imageSize:this.props.imageSize,images:r,litestandSidebar:this.props.litestandSidebar,name:s,status:this.props.status,unreadCount:this.props.unreadCount}));}});function l(n,o){return j.renderRawParticipantList(n,o,o.length,{names_renderer:j.renderShortNames});}function m(n,o){if(n)return n;return o.map(function(p){return p.image_src;});}e.exports=k;});
__d("ChatSidebarThreadlist.react",["ChatConfig","ChatGroupThreadsController","ChatSidebarConstants","ChatSidebarItem.react","ChatSidebarThread.react","MercuryServerRequests","MercuryThreads","MercuryParticipants","PresenceStatus","React","copyProperties","cx","fbt","ix"],function(a,b,c,d,e,f){var g=b('ChatConfig'),h=b('ChatGroupThreadsController'),i=b('ChatSidebarConstants'),j=b('ChatSidebarItem.react'),k=b('ChatSidebarThread.react'),l=b('MercuryServerRequests').get(),m=b('MercuryThreads').get(),n=b('MercuryParticipants'),o=b('PresenceStatus'),p=b('React'),q=b('copyProperties'),r=b('cx'),s=b('fbt'),t=b('ix'),u=p.createClass({displayName:'ChatSidebarThreadlist',render:function(){var v=this.state.threadData,w=this.state.participantData,x=i.IMAGE_SIZE,y=t('/images/chat/sidebar/newGroupChat.png');if(this.props.litestandSidebar){x=g.get('litestand_blended_sidebar')?i.LITESTAND_BLENDED_SIZE:i.LITESTAND_IMAGE_SIZE;y=g.get('litestand_blended_sidebar')?t('/images/litestand/sidebar/blended/new_group_chat.png'):t('/images/chat/sidebar/newGroupChatLitestand.png');}var z="Nuevo chat en grupo...";z=g.get('divebar_group_new_button_name',z);var aa=[];if(this.props.showNewGroupsButton)aa.push(p.DOM.li({className:(("_56yg")+(' '+"_56yj")+(this.props.offlineItems?' '+"_570-":'')),key:"new"},j({images:y,imageSize:x,litestandSidebar:this.props.litestandSidebar,name:z})));var ba={};for(var ca in v){var da=v[ca],ea=da.participants.map(function(ia){return (w||{})[ia];}).filter(function(ia){return ia;}),fa=da.participants.map(function(ia){return n.getUserID(ia);}),ga=fa.sort().join('|');if(!ba[ga]&&ea.length){ba[ga]=1;var ha=l.getServerThreadIDNow(ca);aa.push(p.DOM.li({className:(("_5a58")+(' '+"_56yg")+(this.props.offlineItems?' '+"_570-":'')),'data-serverthreadid':ha,'data-threadid':ca,key:ca},k({image:da.image_src,imageSize:x,litestandSidebar:this.props.litestandSidebar,name:da.name,participants:ea,status:o.getGroup(fa),threadID:ca,unreadCount:da.unread_count})));}}return p.DOM.ul(null,aa);},getInitialState:function(){return {};},componentWillMount:function(){var v=function(){this.setState(this._calculateState());}.bind(this);this.token=h.subscribe('update',v);v();},componentWillUnmount:function(){this.token&&this.token.unsubscribe();this.token=null;},_calculateState:function(){var v=false,w={},x={},y=h.getThreadIDs(),z=y.length;y.forEach(function(ba){m.getThreadMeta(ba,function(ca){x[ba]=ca;n.getMulti(ca.participants,function(da){delete da[n.user];if(v){this.setState(this._calculateState());}else q(w,da);z--;}.bind(this));}.bind(this));}.bind(this));if(z===0){return {threadData:x,participantData:w};}else{v=true;var aa=this.state||{};return {threadData:q(aa.threadData,x),participantData:q(aa.participantData,w)};}}});e.exports=u;});
__d("ChatUnreadCount",["ArbiterMixin","MercuryThreadInformer","MercuryThreads","copyProperties"],function(a,b,c,d,e,f){var g=b('ArbiterMixin'),h=b('MercuryThreadInformer').get(),i=b('MercuryThreads').get(),j=b('copyProperties'),k={};h.subscribe('threads-updated',function(l,m){for(var n in m){var o=i.getCanonicalUserInThread(n);k.inform('unread-changed',o);}});j(k,g,{getUnreadCountForUID:function(l,m){i.getThreadMeta(i.getThreadIdForUser(l),function(n){m(n.unread_count);});}});e.exports=k;});
__d("OrderedFriendsList",["AvailableList","ChatConfig","createArrayFrom","ShortProfiles","InitialChatFriendsList"],function(a,b,c,d,e,f){var g=b('AvailableList'),h=b('ChatConfig'),i=b('createArrayFrom'),j=b('ShortProfiles'),k=[],l={},m=[],n={contains:function(o){return o in l;},compare:function(o,p){var q=n.getRank(o),r=n.getRank(p);if(q!==r)return q-r;var s=j.getNowUnsafe(o),t=j.getNowUnsafe(p),u=((s||{}).name||'~').toLowerCase(),v=((t||{}).name||'~').toLowerCase();if(u!==v)return u<v?-1:1;return 0;},getList:function(){if(h.get('chat_web_ranking_with_presence'))n.reRank();var o=i(k);o=o.filter(function(p){var q=j.getNowUnsafe(p);return !q||q.type=="friend";});return o;},getRank:function(o){return o in l?l[o]:k.length;},reRank:function(){var o={},p={};m.forEach(function(r,s){var t=r.substr(0,r.length-2),u=r.substring(r.length-1);if(typeof(p.uid)=='undefined'){if(typeof(o.uid)=='undefined')o[t]=g.get(t);var v=o[t];if(v==u)p[s]=t;}});k=[];for(var q in p)k.push(p[q]);k.forEach(function(r,s){l[r]=s;});}};(function(){var o=b('InitialChatFriendsList');k=o.list.length?o.list:[];if(h.get('chat_web_ranking_with_presence')){m=k.slice();n.reRank();}k.forEach(function(p,q){l[p]=q;});})();e.exports=a.OrderedFriendsList||n;});
__d("runAfterScrollingStops",["Arbiter","Event","Run","debounceAcrossTransitions","emptyFunction"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('Event'),i=b('Run'),j=b('debounceAcrossTransitions'),k=b('emptyFunction');function l(w,x,y){if(x&&o[x])return;if(!n){g.subscribe('page_transition',v);n=true;}if(!m){w();return;}x&&(o[x]=1);p.push(w);if(!y){if(r){i.onLeave(v);r=false;}q.push(p.length-1);}}var m,n,o={},p=[],q=[],r=true,s=500,t=j(function(){m=false;var w=p;p=[];q=[];o={};for(var x=0,y=w.length;x<y;++x)w[x]();},s);function u(){m=true;t();}function v(){var w=q;q=[];r=true;for(var x=0,y=w.length;x<y;++x)p[w[x]]=k;}h.listen(window,'scroll',u);e.exports=l;});
__d("ChatOrderedList",["Animation","Arbiter","ArbiterMixin","AsyncDialog","AsyncRequest","AvailableList","AvailableListConstants","Bootloader","Chat","ChatConfig","ChatContexts","ChatFavoriteList","ChatFavoriteNux","ChatGroupThreadsController","ChatOrderedListHover","ChatQuietLinks","ChatSidebarThreadlist.react","ChatTypeaheadConstants","ChatUnreadCount","ChatVisibility","CSS","DataStore","DOM","Ease","Event","ImageSourceRequest","ImageSourceType","JSLogger","JSXDOM","LastMobileActiveTimes","MercuryParticipantTypes","OrderedFriendsList","Parent","PhotoResizeModeConst","PresencePrivacy","PresenceStatus","React","Rect","ShortProfiles","Style","TokenizeUtil","Tooltip","URI","Vector","XHPTemplate","copyProperties","createObjectFrom","csx","cx","debounceAcrossTransitions","guid","ix","requestAnimationFrame","runAfterScrollingStops","shield","throttle","tx","mixin","ChannelImplementation"],function(a,b,c,d,e,f){var g=b('Animation'),h=b('Arbiter'),i=b('ArbiterMixin'),j=b('AsyncDialog'),k=b('AsyncRequest'),l=b('AvailableList'),m=b('AvailableListConstants'),n=b('Bootloader'),o=b('Chat'),p=b('ChatConfig'),q=b('ChatContexts'),r=b('ChatFavoriteList'),s=b('ChatFavoriteNux'),t=b('ChatGroupThreadsController'),u=b('ChatOrderedListHover'),v=b('ChatQuietLinks'),w=b('ChatSidebarThreadlist.react'),x=b('ChatTypeaheadConstants'),y=b('ChatUnreadCount'),z=b('ChatVisibility'),aa=b('CSS'),ba=b('DataStore'),ca=b('DOM'),da=b('Ease'),ea=b('Event'),fa=b('ImageSourceRequest'),ga=b('ImageSourceType'),ha=b('JSLogger'),ia=b('JSXDOM'),ja=b('LastMobileActiveTimes'),ka=b('MercuryParticipantTypes'),la=b('OrderedFriendsList'),ma=b('Parent'),na=b('PhotoResizeModeConst'),oa=b('PresencePrivacy'),pa=b('PresenceStatus'),qa=b('React'),ra=b('Rect'),sa=b('ShortProfiles'),ta=b('Style'),ua=b('TokenizeUtil'),va=b('Tooltip'),wa=b('URI'),xa=b('Vector'),ya=b('XHPTemplate'),za=b('copyProperties'),ab=b('createObjectFrom'),bb=b('csx'),cb=b('cx'),db=b('debounceAcrossTransitions'),eb=b('guid'),fb=b('ix'),gb=b('requestAnimationFrame'),hb=b('runAfterScrollingStops'),ib=b('shield'),jb=b('throttle'),kb=b('tx'),lb=b("mixin"),mb=b('ChannelImplementation').instance,nb=p.get('chat_ranked_by_coefficient',0),ob=null,pb,qb,rb=9,sb=lb(i);for(var tb in sb)if(sb.hasOwnProperty(tb))vb[tb]=sb[tb];var ub=sb===null?null:sb.prototype;vb.prototype=Object.create(ub);vb.prototype.constructor=vb;vb.__superConstructor__=sb;function vb(cc,dc,ec,fc,gc,hc){this._isSidebar=cc;this._isLitestand=p.get('litestand',0)||p.get('test_litestand_sidebar',0);this._isLitestandSidebar=this._isSidebar&&this._isLitestand;this._isLeftCollapsedSidebar=!!ma.byClass(dc,"_5ap0");this._root=dc;this._itemsMap={};this._isVisible=false;this._excludedIds={};this._numTopFriends=5;this._hasRendered=false;this._preventRendering=false;this._hoverController=null;this._template=ec;this._messageTemplate=fc;this._favoriteMode=p.get('divebar_favorite_list',0);this._contextualDialog=gc;this._cachedItemHeight=null;this._cachedItemPadding=null;if(hc&&ca.scry(hc,"._54y_").length){aa.show(hc);this._pymk=hc;}this._usePlaceholder=this._isLitestand&&this._isSidebar;if(p.get('groups_in_divebar')){this._groupThreadsNode=ia.li({className:"_56yf"});this._updateGroupThreads();this._groupsList=this._favoriteMode&&ca.find(this._root,"._56yh");}if(this._favoriteMode){this._favoriteSidebar=ca.find(this._root,"._42g5");this._editButton=ca.scry(this._root,"._57m9 ._54sl")[0];this._favoriteList=ca.find(this._root,"._54sm");this._activeNowList=ca.find(this._root,"._54sn");this._activeNowLabel=ca.scry(this._root,"._42g9")[0];if(this._activeNowLabel)this._activeNowArea=ma.byClass(this._activeNowLabel,"_57yh");}this._orderedList=ca.find(this._root,'.fbChatOrderedList');this._scrollableOrderedList=ma.byClass(this._root,'scrollableOrderedList');this._chatSidebar=ma.byClass(this._root,'fbChatSidebar');this._scrollableArea=ma.byClass(this._root,'scrollable');ea.listen(this._root,'click',this._onClick.bind(this));ea.listen(this._root,'mouseenter',this._mouseEnter.bind(this));ea.listen(this._root,'mouseleave',this._mouseLeave.bind(this));if(this._editButton){ea.listen(this._editButton,'click',this.toggleEditMode.bind(this));h.subscribe(['LitestandSidebarBookmarks/close','LitestandSidebar/collapse'],this._onEditEnd.bind(this));}h.subscribe(['LitestandSidebar/collapse','LitestandSidebar/expand'],function(event){if(this._isLitestandSidebar)this.getHoverController().setPaused(event==='LitestandSidebar/collapse');this.render();}.bind(this));l.subscribe(m.ON_AVAILABILITY_CHANGED,ib(this.update,this));oa.subscribe('privacy-changed',ib(this.update,this));mb.subscribe([mb.CONNECTED,mb.RECONNECTING,mb.SHUTDOWN,mb.MUTE_WARNING,mb.UNMUTE_WARNING],ib(this.update,this));this.inform('initialized',this,h.BEHAVIOR_PERSISTENT);this.render();h.subscribe(ha.DUMP_EVENT,function(ic,jc){jc.chat_lists=jc.chat_lists||{sorted_list:this.getCachedSortedList(),ordered_list:la.getList(),available_list:vb.getAvailableList(this._excludedIds),excluded_list:this._excludedIds};}.bind(this));h.subscribe('ChatOrderedList/itemHeightChange',function(){this._cachedItemHeight=null;this._cachedItemPadding=null;}.bind(this));this._renderUnreadCount=p.get('divebar_message_count');if(this._renderUnreadCount)y.subscribe('unread-changed',function(ic,jc){if(!this._renderedTopUsers||!(jc in this._renderedTopUsers)||!this._itemsMap[jc])return;y.getUnreadCountForUID(jc,this._updateUnreadCount.bind(this,jc));}.bind(this));}vb.prototype.getAllNodes=function(){var cc={},dc=ca.scry(this._root,"li._42fz");for(var ec=0;ec<dc.length;ec++){var fc=ba.get(dc[ec],'id');if(fc)cc[fc]=dc[ec];}return cc;};vb.prototype.getShowingUsers=function(){return ca.scry(this._root,"li._42fz,li._5a58").map(this.getUserForNode);};vb.prototype.getUserForNode=function(cc){return ba.get(cc,'id')||ba.get(cc,'serverthreadid');};vb.prototype.getHoverController=function(){if(!this._hoverController){this._hoverController=new u(this,this._contextualDialog);if(this._isLitestandSidebar&&this._isLitestandSidebarCollapsed())this._hoverController.setPaused(true);}return this._hoverController;};vb.prototype._isLitestandSidebarCollapsed=function(){if(this._isLeftCollapsedSidebar)return true;if(pb)return !pb.isExpanded();n.loadModules(['LitestandSidebar'],function(cc){pb=cc;});return aa.hasClass(document.documentElement,"_4kdq");};vb.prototype.getPaddingOffset=function(){return this._favoriteMode?24:8;};vb.prototype._calculateItemMeasurements=function(){var cc=this._orderedList,dc=this._template.build(),ec=dc.getRoot();ca.setContent(dc.getNode('name'),'test');if(this._favoriteSidebar){cc=this._favoriteList;aa.addClass(this._favoriteSidebar,"_4zmr");}ec.style.visibility='hidden';ca.appendContent(cc,ec);this._cachedItemHeight=xa.getElementDimensions(ec).y;this._cachedItemPadding=ta.getFloat(dc.getNode('anchor'),'padding')||0;ca.remove(ec);if(this._favoriteSidebar)aa.removeClass(this._favoriteSidebar,"_4zmr");};vb.prototype.getItemHeight=function(){if(this._cachedItemHeight===null)this._calculateItemMeasurements();return this._cachedItemHeight;};vb.prototype.getItemPadding=function(){if(this._cachedItemPadding===null)this._calculateItemMeasurements();return this._cachedItemPadding;};vb.prototype._updateGroupThreads=function(){if(this._groupThreadsNode){var cc=oa.getVisibility(),dc=w({offlineItems:mb.disconnected()||!cc,litestandSidebar:this._isSidebar&&this._isLitestand&&!p.get('test_old_divebar'),showNewGroupsButton:p.get('divebar_has_new_groups_button',false)});qa.renderComponent(dc,this._groupThreadsNode);}};vb.prototype._placeholderUpdate=function(){if(!this._usePlaceholder||!this._scrollContainer)return;var cc=this._root.offsetTop-this._scrollContainer.scrollTop;this._scrollContainerHeight=this._scrollContainerHeight||this._scrollContainer.offsetHeight;var dc=this.getItemHeight(),ec=Math.ceil(this._scrollContainerHeight/dc),fc=cc<0?Math.max(Math.floor(-cc/dc)-ec,0):0,gc=fc+ec+ec;this._cachedItems=this._cachedItems||ca.scry(this._root,"li._42fz");for(var hc=0,ic=this._cachedItems.length;hc<ic;hc++)aa.conditionClass(this._cachedItems[hc],"_50zv",hc<fc||hc>gc);};vb.prototype._getListItem=function(cc,dc){var ec=this._itemsMap[cc];if(!ec)return;var fc=pa.get(cc),gc=pa.isBirthday(cc),hc=oa.allows(cc)&&!mb.disconnected();if(ec.buttonNode===undefined){ec.buttonNode=ca.scry(ec.node,"._54sk")[0];ec.contextNode=ca.find(ec.node,"._52zk");ec.timeNode=ca.scry(ec.node,'.active_time')[0];ec.statusNodes=ca.scry(ec.node,'img.status');}aa.conditionClass(ec.node,"_42f-",dc);aa.conditionClass(ec.node,"_54sj",dc);aa.conditionClass(ec.node,"_52s3",this._isLitestand&&dc);if(ec.buttonNode)if(!this._isLitestand){aa.conditionClass(ec.buttonNode,"_42f_",dc);aa.conditionClass(ec.buttonNode,"_42g0",!dc);}var ic={active:false,mobile:false,birthday:false};ic.active=fc===m.ACTIVE;ic.mobile=fc===m.MOBILE;ic.birthday=gc;if(ic.mobile){var jc=ja.getShortDisplay(cc);if(ec.timeNode&&ec.lastActiveTime!==jc){ec.lastActiveTime=jc;ca.setContent(ec.timeNode,jc);}}else if(ec.lastActiveTime){ec.lastActiveTime=null;ca.empty(ec.timeNode);}for(var kc in ic)aa.conditionClass(ec.node,kc,ic[kc]&&hc);aa.conditionClass(ec.node,'invis',!hc);var lc=aa.hasClass(document.documentElement,'highContrast');ec.statusNodes.forEach(function(mc){if(fc===m.ACTIVE&&hc){mc.alt="En l\u00ednea";if(lc)mc.src=fb('/images/chat/status/online.png');}else if(fc===m.MOBILE&&hc){mc.alt="Celular";if(lc)mc.src=fb('/images/chat/status/mobile.png');}else{mc.alt='';if(lc)mc.src=fb('/images/spacer.gif');}});this._applyContext(cc,ec);return ec.node;};vb.prototype.getRoot=function(){return this._root;};vb.prototype.getSortedList=function(cc){return vb.getSortedList(cc||this._excludedIds,this._numTopFriends);};vb.prototype.getCachedSortedList=function(cc){if(ob==null)ob=this.getSortedList(cc);return ob;};vb.prototype.toggleFavoriteSidebar=function(cc,dc){function ec(hc,ic){aa.conditionShow(ic,hc);var jc=ma.byClass(ic,'uiContextualLayerPositioner');jc&&aa.conditionShow(jc,hc);}aa.conditionShow(this._orderedList,!cc);if(this._favoriteSidebar)aa.conditionShow(this._favoriteSidebar,cc);var fc=ca.scry(this._scrollableOrderedList||this._root,"._42i3");fc.forEach(ec.curry(cc));var gc=ca.scry(this._scrollableOrderedList||this._root,"._56yi");gc.length&&ec(dc,gc[0]);};vb.prototype.hide=function(){if(!this._isVisible)return;this._isVisible=false;s.tryHide();aa.hide(this._scrollableOrderedList||this._root);this.inform('hide');};vb.prototype._onFavoriteOrderChange=function(){var cc=this.sortableGroup.getOrder();r.updateList(cc);r.save();};vb.prototype._getFavoriteItems=function(){var cc=[],dc=r.get();for(var ec=0;ec<dc.length;ec++){var fc=this._itemsMap[dc[ec]];if(fc)cc.push(fc.node);}return cc;};vb.prototype._getChatTabOpenLogData=function(cc){var dc=aa.hasClass(document.documentElement,'sidebarMode'),ec={mode:dc?'sidebar':'chatNub',typehead:false};if(this._scrollableArea&&this._scrollContainer){var fc=xa.getElementPosition(this._scrollableArea,'viewport').y,gc=xa.getElementPosition(cc,'viewport').y,hc=this._scrollContainer.scrollTop;if(gc>fc){ec.visible_slot=Math.round((gc-fc)/32);var ic=Math.round(hc/32);ec.global_slot=ec.visible_slot+ic;}}if(dc){ec.sidebar_height=this._chatSidebar&&this._chatSidebar.clientHeight;if(this._scrollContainer)ec.buddylist_height=this._scrollContainer.clientHeight;}return ec;};vb.prototype._resetFavoriteBounds=function(){var cc=r.get(),dc=cc.length;if(dc){var ec=cc[0],fc=cc[dc-1],gc=this._itemsMap[ec],hc=this._itemsMap[fc],ic=new ra(xa.getElementPosition(gc.node).y,0,xa.getElementPosition(hc.node).y+xa.getElementDimensions(hc.node).y,0);this.sortableGroup.setBoundingBox(ic);}};vb.prototype._createSortableGroup=function(){if(this.sortableGroup)this.sortableGroup.destroy();n.loadModules(['SortableGroup'],function(cc){this.sortableGroup=new cc().setBeforeGrabCallback(this._resetFavoriteBounds.bind(this)).setOrderChangeHandler(this._onFavoriteOrderChange.bind(this));if(this._isLitestand)this.sortableGroup.gutter=1;var dc=this._getFavoriteItems();for(var ec=0;ec<dc.length;ec++){var fc=dc[ec];this.sortableGroup.addSortable(ba.get(fc,'id'),fc);}}.bind(this));};vb.prototype.toggleEditMode=function(){s.dismissDialog();r.toggleEditMode();if(r.isEditMode()){this._createSortableGroup();ca.setContent(this._editButton,"LISTO");aa.addClass(this._favoriteSidebar,"_4-d6");this.inform('editStart');}else this._onEditEnd();};vb.prototype._onEditEnd=function(){if(r.isEditMode())r.toggleEditMode();ca.setContent(this._editButton,"EDITAR");aa.removeClass(this._favoriteSidebar,"_4-d6");this.inform('editEnd');};vb.prototype._onClick=function(event){var cc=event.getTarget(),dc=ma.byTag(cc,'li');if(r.isEditMode()){var ec=ma.byClass(cc,"_54sk");if(ec&&dc){var fc=ba.get(dc,'id');if(fc){r.toggleID(fc);r.save();}this.update();}event.prevent();return false;}if(dc){if(aa.hasClass(dc,'blackbirdWhitelist')){var gc=new wa('/ajax/chat/privacy/settings_dialog.php').addQueryData({ref:'whitelist_separator'});j.send(new k(gc));event.prevent();return false;}var hc=ba.get(dc,'id'),ic=aa.hasClass(dc,"_56yg");if(hc||ic){var jc=this._getChatTabOpenLogData(dc),kc=aa.hasClass(document.documentElement,'sidebarMode'),lc=oa.getOnlinePolicy()===oa.ONLINE_TO_WHITELIST,mc=lc?'white_list':'ordered_list';if(ic){hc=dc.getAttribute('data-threadid');mc=hc?'recent_threads_in_divebar':'recent_threads_in_divebar_new';}else if(kc&&this._favoriteMode&&!lc){while(dc.parentNode){dc=dc.parentNode;if(aa.hasClass(dc,"_42g8")){mc='more_online_friends';break;}if(aa.hasClass(dc,"_42g7"))break;}}else while(dc.previousSibling){dc=dc.previousSibling;if(aa.hasClass(dc,"_554m")){if(aa.hasClass(dc,'moreOnlineFriends')){mc='more_online_friends';break;}if(aa.hasClass(dc,'blackbirdWhitelist')){mc='blackbird_offline_section';break;}}}jc.source=mc;var nc=ic?x.THREAD_TYPE:ka.FRIEND;o.openTab(hc,nc,jc);this.inform('click',{id:hc});}else if(aa.hasClass(dc,"_554m")&&ma.byClass(cc,"_554n")){this.scrollTo(dc);}else if(aa.hasClass(dc,"_55nf"))return;return false;}};vb.prototype._mouseEnter=function(){this._preventRendering=true;};vb.prototype._mouseLeave=function(){this._preventRendering=false;};vb.prototype.setExcludedIds=function(cc){this._excludedIds=ab(cc||[]);};vb.prototype.setNumTopFriends=function(cc){if(cc!==this._numTopFriends){this._numTopFriends=cc;this.render();}};vb.prototype._getOfflineToSectionItems=function(){var cc='subheader-text-'+eb(),dc=ca.create('a',{href:'#','aria-describedby':cc},ca.tx._("Editar")),ec=[],fc=ca.tx._("M\u00c1S AMIGOS");ec.push(ia.li({className:"_554m"},ia.div({className:"_554o"},ia.div({className:"_554n"},ia.span({className:"_554p"},fc),ia.div({className:"_554q"},ia.span({className:"_554r"}))))));ec.push(ia.li({className:"_554m blackbirdWhitelist"},ia.div({className:"_554o"},ia.div({className:"fbChatOrderedList/separatorInner"},ia.div({className:"fbChatOrderedList/separatorSubheader"},ia.span({id:cc,className:"_554t"},kb._("Estos amigos no pueden verte en el chat. {=link}",{'=link':dc})))))));return ec;};vb.prototype._renderOrderedList=function(){if(!this._isVisible||(this._preventRendering&&this._hasRendered)||qb)return;this._hasRendered=true;this._cachedItems=null;var cc=[],dc,ec,fc=false,gc=false,hc=p.get('divebar_has_new_groups_button',false),ic=aa.hasClass(document.documentElement,'sidebarMode'),jc=oa.getVisibility(),kc=oa.getOnlinePolicy()===oa.ONLINE_TO_WHITELIST,lc=this._isLitestandSidebar&&this._isLitestandSidebarCollapsed(),mc=p.get('groups_in_divebar');mc&&this._updateGroupThreads();var nc=mc&&t.getThreadIDs().length,oc=ic&&this._favoriteMode&&jc&&!kc;if(oc&&mc&&nc&&this._groupThreadsNode){ca.setContent(this._groupsList,this._groupThreadsNode);v.nukeLinks(this._groupThreadsNode);v.nukeLinks(this._favoriteList);this.inform('render');}var pc=oc&&this._groupThreadsNode&&this._groupsList,qc=pc&&nc,rc=this._isLitestand&&!ma.byClass(this._root,"_4w59");if(pc&&(nc||rc&&hc)){ca.setContent(this._groupsList,this._groupThreadsNode);aa.show(this._groupsList);v.nukeLinks(this._favoriteList);this.inform('render');}else this._groupsList&&aa.hide(this._groupsList);var sc=nc||0;if(hc&&(qc||!oc))sc++;var tc=[],uc,vc;if(oc){this._chatSidebar&&aa.addClass(this._chatSidebar,'fbSidebarFavoriteList');tc=r.get();if(lc)tc=tc.slice(0,Math.max(0,this._numTopFriends-sc));for(uc=0,vc=tc.length;uc<vc;uc++){dc=tc[uc];ec=this._getListItem(dc,true);if(ec){cc.push(ec);}else{gc=true;this._renderListItem(dc,this.update.bind(this));}}}this.toggleFavoriteSidebar(oc,qc);var wc=lc?1:0,xc=vb.getSortedList(ab(tc),Math.max(0,this._numTopFriends-tc.length-sc+wc));if(oc){if(tc.length&&xc.length){var yc=ca.create('li',{className:"_42g3"});cc.push(yc);}}else if(nc||hc)this._groupThreadsNode&&cc.push(this._groupThreadsNode);var zc=oa.getVisibility()&&oa.getOnlinePolicy()==oa.ONLINE_TO_WHITELIST;for(var ad=0,bd=xc.length;ad<bd;ad++){dc=xc[ad];if(zc)if(!oa.allows(dc)){if(ad+2>=xc.length)break;zc=false;var cd=this._getOfflineToSectionItems();cc.push(cd[0]);cc.push(cd[1]);bd-=2;}ec=this._getListItem(dc);if(ec){cc.push(ec);}else this._renderListItem(dc,this.render.bind(this));}if(oc){ca.setContent(this._favoriteList,cc);if(cc.length)v.nukeLinks(this._favoriteList);this.inform('render');}var dd;if(lc){dd=[];}else dd=vb.getAvailableList(this._excludedIds);var ed=tc.concat(xc),fd=ab(ed);dd=dd.filter(function(od){return !(od in fd);});if(this._renderUnreadCount){var gd=[];if(this._renderedTopUsers){var hd=Object.keys(this._renderedTopUsers).filter(function(od){return !(od in fd);});hd.forEach(function(od){this._updateUnreadCount(od,0);}.bind(this));ed.forEach(function(od){if(!(od in this._renderedTopUsers))gd.push(od);}.bind(this));}else gd=ed;var id=this._updateUnreadCount.bind(this);gd.forEach(function(od){y.getUnreadCountForUID(od,function(pd){id(od,pd);});});this._renderedTopUsers=fd;}if(p.get('divebar_show_mobile_more_friends_alphabetical')){dd.sort(ac);}else dd.sort(bc);var jd="M\u00c1S AMIGOS";if(oc){cc=[];}else if(dd.length&&cc.length){var kd;if(this._isLitestand){kd=ia.span(null,ia.span({className:"_554u"},jd," · ",dd.length),ia.span({className:"_554v"}," +",dd.length));}else kd=kb._("{MORE ONLINE FRIENDS} ({=count})",{'MORE ONLINE FRIENDS':jd,'=count':dd.length});if(this._pymk){fc=true;cc.push(this._pymk);}cc.push(ia.li({className:"_554m moreOnlineFriends"},ia.div({className:"_554o"},ia.div({className:"_554n"},ia.span({className:"_554p"},kd),ia.div({className:"_554q"},ia.span({className:"_554r"}))))));}for(uc=0,vc=dd.length;uc<vc;uc++){dc=dd[uc];ec=this._getListItem(dc);if(ec){cc.push(ec);}else this._renderListItem(dc,this.render.bind(this));}if(!xc.length&&!dd.length&&!sc){var ld=this._messageTemplate.render(),md=ya.getNode(ld,'message');ca.setContent(md,"No hay nadie disponible para chatear.");cc.push(ld);}if(cc.length){if(oc){aa.show(this._activeNowList);if(this._activeNowLabel){var nd;aa.show(this._activeNowArea);if(this._isLitestand){nd=ia.span(null,ia.span({className:"_554u"},jd," · ",dd.length),ia.span({className:"_554v"}," +",dd.length));}else nd=kb._("{MORE ONLINE FRIENDS} ({=count})",{'MORE ONLINE FRIENDS':"ACTIVOS",'=count':dd.length});ca.setContent(this._activeNowLabel,nd);}ca.setContent(this._activeNowList,cc);v.nukeLinks(this._activeNowList);}else{if(this._pymk&&!fc)cc.push(this._pymk);ca.setContent(this._orderedList,cc);if(this._pymk){v.removeMessagesHrefs(this.getRoot());}else v.nukeLinks(this.getRoot());}this.inform('render');this._placeholderUpdate();if(!this._renderingAfterScroll){this._renderingAfterScroll=true;this.render=db(hb.curry(this._renderOrderedList.bind(this),'ChatOrderedList/render',true),300);}}else if(oc){aa.hide(this._activeNowList);if(this._activeNowArea)aa.hide(this._activeNowArea);}if(oc){this._editButton&&s.tryShow(this._editButton);}else s.tryHide();if(oc&&!gc)if(r.isEditMode()&&r.hasChanged())this._createSortableGroup();};vb.prototype.render=function(){this.render=db(this._renderOrderedList.bind(this),300);this.render();};vb.prototype._renderListItem=function(cc,dc){sa.get(cc,function(ec){var fc=this._template.render(),gc=ya.getNode(fc,'profile-photo');if(p.get('chat_use_client_side_image_requests',0)){var hc=this._isLitestand?24:28;new fa().setFBID(ec.id).setType(ga.PROFILE_PICTURE).setDimensions(hc,hc).setResizeMode(na.COVER).setCallback(function(mc){gc.setAttribute('src',mc.uri);}).send();}else gc.setAttribute('src',ec.thumbSrc);var ic=ya.getNode(fc,'name');ca.setContent(ic,ec.name);var jc=ya.getNode(fc,'accessible-name');ca.setContent(jc,ec.name);var kc=ya.getNode(fc,'anchor');kc.setAttribute('href','/messages/'+cc);var lc=ya.getNode(fc,'tooltip');lc&&va.set(lc,ec.name,'right');ba.set(fc,'id',cc);this._itemsMap[cc]={node:fc};dc&&dc(fc);}.bind(this));};vb.prototype._updateUnreadCount=function(cc,dc){var ec=this._itemsMap[cc];if(!ec)return;if(this._isSidebar){this._unreadMessages=this._unreadMessages||{};if(!!dc){this._unreadMessages[cc]=true;}else delete this._unreadMessages[cc];h.inform('buddylist-nub/updateCount',{count:Object.keys(this._unreadMessages).length});}ec.unreadCount=ec.unreadCount||ca.find(ec.node,"._550_");dc=dc?dc:0;ca.setContent(ec.unreadCount,dc>rb?rb+'+':dc);aa.conditionClass(ec.unreadCount,"_550z",dc>rb);aa.conditionClass(ec.node,"_550-",dc);};vb.prototype.show=function(){if(this._isVisible)return;this._isVisible=true;aa.show(this._scrollableOrderedList||this._root);this.render();this.inform('show');};vb.prototype.isVisible=function(){return this._isVisible;};vb.prototype.update=function(){this._hasRendered=false;if(!this._renderRequest)this._renderRequest=gb(function(){this.render();this._renderRequest=null;}.bind(this));};vb.prototype.setScrollContainer=function(cc){if(ca.contains(cc,this._root)){this._scrollContainer=cc;if(this._usePlaceholder){ea.listen(cc,'scroll',jb.acrossTransitions(this._placeholderUpdate.bind(this)));ea.listen(window,'resize',jb.acrossTransitions(function(){this._scrollContainerHeight=null;this._placeholderUpdate();}.bind(this),250));}}};vb.prototype.scrollTo=function(cc){if(!this._scrollContainer)return;var dc=this._scrollContainer.scrollHeight,ec=this._scrollContainer.clientHeight,fc=this._scrollContainer.scrollTop,gc=Math.min(cc.offsetTop,dc-ec);if(fc!==gc){var hc=this._isLitestand?600:Math.abs(gc-fc)/this._scrollContainer.clientHeight*500,ic=this._isLitestand?da.easeOutExpo:g.ease.end;new g(this._scrollContainer).to('scrollTop',gc).ease(ic).duration(hc).go();}};vb.prototype._applyContext=function(cc,dc){var ec=q.getShortDisplay(cc)||'';if(dc.contextNode){ca.setContent(dc.contextNode,ec);aa.conditionClass(dc.node,"_52zj",ec);var fc=q.get(cc),gc=fc?fc.type:null;for(var hc in vb.CONTEXT_CLASSES){var ic=(hc===gc),jc=vb.CONTEXT_CLASSES[hc]||"_56x-";aa.conditionClass(dc.contextNode,jc,ic);}}};vb.getSortedList=function(cc,dc){var ec=la.getList().filter(function(hc){return !(hc in cc)&&oa.getFriendVisibility(hc)!==oa.BLACKLISTED;}),fc=[];if(!z.isOnline()){Array.prototype.push.apply(fc,ec);}else{if(oa.getOnlinePolicy()===oa.ONLINE_TO_WHITELIST)ec=this._filterByWhitelist(ec);if(p.get('chat_web_ranking_with_presence')){Array.prototype.push.apply(fc,ec);}else fc=this._splitOutTopFriends(ec,dc);}fc=fc.slice(0,dc);if(fc.length===dc){var gc=vb.getAvailableList(fc.concat(cc)).length;gc&&fc.splice(-1);}if(!p.get('chat_web_ranking_with_presence'))fc.sort(wb);ob=fc.slice();return fc;};vb._filterByWhitelist=function(cc){var dc=cc,ec={},fc,gc;cc=[];for(fc=0;fc<dc.length;++fc){gc=dc[fc];if(oa.allows(gc)){ec[gc]=true;cc.push(gc);}}var hc=oa.getWhitelist();for(fc=0;fc<hc.length;++fc){gc=hc[fc];if(!(gc in ec))cc.push(gc);}for(fc=0;fc<dc.length;++fc){gc=dc[fc];if(!oa.allows(gc))cc.push(gc);}return cc;};vb._splitOutTopFriends=function(cc,dc){var ec=[],fc=[],gc=p.get('ordered_list.top_friends',0),hc=p.get('ordered_list.top_mobile',0),ic=dc,jc=cc.length;for(var kc=0;kc<jc&&ic>0;kc++){var lc=cc[kc],mc=pa.get(lc),nc=mc===m.ACTIVE;if(nc||(mc===m.MOBILE&&kc<hc)||kc<gc){ec.push(lc);nc&&ic--;}else fc.push(lc);}if(kc<jc)Array.prototype.push.apply(fc,cc.slice(kc));if(ec.length<dc)Array.prototype.push.apply(ec,fc);return ec;};vb.getAvailableList=function(cc){var dc;if(p.get('divebar_show_mobile_more_friends')||p.get('divebar_show_mobile_more_friends_alphabetical'))dc=l.getAvailableIDs();if(!dc)dc=l.getOnlineIDs();return dc.filter(function(ec){return !(ec in cc);});};vb._pause=function(){qb=true;};vb._unpause=function(){qb=false;};vb._registerToggleRenderItem=function(cc){ea.listen(cc,'click',function(){qb=!qb;aa.conditionClass(cc,'checked',qb);});};function wb(cc,dc){var ec=xb(cc,dc);if(ec!==0)return ec;if(!nb){var fc=ac(cc,dc);if(fc!==0)return fc;}return la.compare(cc,dc);}function xb(cc,dc){var ec=oa.allows(cc),fc=oa.allows(dc);if(ec!==fc)return ec?-1:1;return 0;}var yb={};function zb(cc){return yb[cc]||(yb[cc]=ua.flatten(cc));}function ac(cc,dc){var ec=sa.getNowUnsafe(cc),fc=sa.getNowUnsafe(dc),gc=zb((ec||{}).name||'~'),hc=zb((fc||{}).name||'~');if(gc!==hc)return gc<hc?-1:1;return 0;}function bc(cc,dc){var ec=pa.get(cc)===m.MOBILE,fc=pa.get(dc)===m.MOBILE;if(ec!==fc)return fc?-1:1;return ac(cc,dc);}za(vb,{CONTEXT_CLASSES:{nearby:"_56xw",visiting:"_56xx",neighbourhood:"_56xy",listening:"_56xz"}});e.exports=vb;});
__d("BlendedChatSidebar",["Arbiter","ArbiterMixin","Event","Style","SubscriptionsHandler","TinyViewport","Vector","mixin","queryThenMutateDOM"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('ArbiterMixin'),i=b('Event'),j=b('Style'),k=b('SubscriptionsHandler'),l=b('TinyViewport'),m=b('Vector'),n=b('mixin'),o=b('queryThenMutateDOM'),p=n(h);for(var q in p)if(p.hasOwnProperty(q))s[q]=p[q];var r=p===null?null:p.prototype;s.prototype=Object.create(r);s.prototype.constructor=s;s.__superConstructor__=p;function s(t){this.$BlendedChatSidebar0=t;this.onViewportUpdate();l.subscribe('change',this.onViewportUpdate.bind(this));}s.prototype.onViewportUpdate=function(){if(l.isTiny()){this.onScroll();var t=this.onScroll.bind(this);this.$BlendedChatSidebar1=new k();this.$BlendedChatSidebar1.addSubscriptions(i.listen(window,'scroll',t),g.subscribe('dom-scroll',t));}else{if(this.$BlendedChatSidebar2!==0){j.set(this.$BlendedChatSidebar0,'margin-top','0');this.$BlendedChatSidebar2=0;}this.$BlendedChatSidebar1&&this.$BlendedChatSidebar1.release();}};s.prototype.onScroll=function(){o(this.updateScrollPosition.bind(this),this.resizeSidebar.bind(this),'BlendedChatSidebar/scroll');};s.prototype.updateScrollPosition=function(){this.$BlendedChatSidebar3=m.getScrollPosition().y;this.$BlendedChatSidebar4||(this.$BlendedChatSidebar4=this.$BlendedChatSidebar0.offsetHeight);};s.prototype.resizeSidebar=function(){var t=-Math.max(Math.min(this.$BlendedChatSidebar3,this.$BlendedChatSidebar4),0);j.set(this.$BlendedChatSidebar0,'margin-top',t+'px');if(t!=this.$BlendedChatSidebar2){this.$BlendedChatSidebar2=t;this.inform('resized',t);}};s.prototype.getOffset=function(){return this.$BlendedChatSidebar2;};e.exports=s;});
__d("ChatTypeaheadBehavior",["Chat","ChatConfig","ChatFavoriteList","CSS","DOM","Rect","copyProperties","tx"],function(a,b,c,d,e,f){var g=b('Chat'),h=b('ChatConfig'),i=b('ChatFavoriteList'),j=b('CSS'),k=b('DOM'),l=b('Rect'),m=b('copyProperties'),n=b('tx');function o(p){this._typeahead=p;}o.prototype.enable=function(){var p=this._typeahead;this._subscriptions=[p.subscribe('focus',function(){p.getData().refreshData();}),p.subscribe('blur',function(q){p.getCore().reset();}),p.subscribe('respond',function(q,r){if(r.value&&r.value===p.getCore().getValue()){if(!r.results.length){var s=h.get('divebar_typeahead_group_fof',0);if(s&&!r.isAsync)return;var t=k.create('div',{className:'noResults'},"No pudimos encontrar a tu amigo(a)");k.setContent(p.getView().getElement(),t);}j.addClass(p.getElement(),'hasValue');}}),p.subscribe('reset',function(){j.removeClass(p.getElement(),'hasValue');}),p.subscribe('select',function(q,r){if(i.isEditMode()){i.toggleID(r.selected.uid);i.save();}else{var s=j.hasClass(document.documentElement,'sidebarMode'),t={mode:s?'sidebar':'chatNub',source:'typeahead',type:r.selected.type,typeahead:true};g.openTab(r.selected.uid,r.selected.type,t);}}),p.subscribe('highlight',function(q,r){if(r.index>=0){var s=p.getView().getItems()[r.index];if(s){var t=new l(s),u=s.offsetParent,v=t.boundWithin(new l(u)).getPositionVector();t.getPositionVector().sub(v).scrollElementBy(u);}}})];};o.prototype.disable=function(){this._subscriptions.forEach(function(p){this._typeahead.unsubscribe(p);}.bind(this));this._subscriptions=null;};m(o.prototype,{_subscriptions:null});e.exports=o;});
__d("ChatTypeaheadCore",["function-extensions","Event","Keys","TypeaheadCore","copyProperties","emptyFunction","shield"],function(a,b,c,d,e,f){b('function-extensions');var g=b('Event'),h=b('Keys'),i=b('TypeaheadCore'),j=b('copyProperties'),k=b('emptyFunction'),l=b('shield');for(var m in i)if(i.hasOwnProperty(m))o[m]=i[m];var n=i===null?null:i.prototype;o.prototype=Object.create(n);o.prototype.constructor=o;o.__superConstructor__=i;function o(){if(i!==null)i.apply(this,arguments);}o.prototype.init=function(p,q,r){n.init.call(this,p,q,r);this.informBeginActive=false;this.informEndActive=false;this.data.subscribe('respond',function(){if(this.informBeginActive){this.informBeginActive=false;this.inform('sidebar/typeahead/active',true);}else if(this.informEndActive){this.informEndActive=false;this.inform('sidebar/typeahead/active',false);}}.bind(this));};o.prototype.keydown=function(event){var p=g.getKeyCode(event);if(p===h.ESC){l(this.reset,this).defer();if(!this.getValue()){this.element.blur();this.inform('escape');}return event.kill();}return n.keydown.call(this,event);};o.prototype.checkValue=function(){var p=this.getValue(),q=this.value;if(p==q)return;if(q&&!p){this.typeaheadActive=false;this.informEndActive=true;}else if(!q&&p){this.typeaheadActive=true;this.informBeginActive=true;this.inform('sidebar/typeahead/preActive');}n.checkValue.call(this);};j(o.prototype,{handleTab:k});e.exports=o;});
__d("ChatTypeaheadDataSource",["DataSource","Env","JSLogger","MercuryParticipantTypes","OrderedFriendsList","Run","ShortProfiles"],function(a,b,c,d,e,f){var g=b('DataSource'),h=b('Env'),i=b('JSLogger'),j=b('MercuryParticipantTypes'),k=b('OrderedFriendsList'),l=b('Run'),m=b('ShortProfiles');for(var n in g)if(g.hasOwnProperty(n))p[n]=g[n];var o=g===null?null:g.prototype;p.prototype=Object.create(o);p.prototype.constructor=p;p.__superConstructor__=g;function p(q){q=q||{};q.kanaNormalization=true;g.call(this,q);this.persistOnRefresh=q.persistOnRefresh!==false;this.showOfflineUsers=!!q.showOfflineUsers;this._jslog=i.create('chat_typeahead');this._jslog.log('created');}p.prototype.init=function(){this._jslog.log('init');o.init.call(this);this._update();};p.prototype.bootstrap=function(){this._jslog.log('bootstrap');o.bootstrap.call(this);if(this.showOfflineUsers){this._jslog.log('show_offline_users');this._jslog.log('ensured_short_profiles');if(m.hasAll()){this._update();}else{this._jslog.log('fetch_all_short_profiles');m.fetchAll();this.inform('activity',{activity:true});var q=m.subscribe('updated',function(){this.inform('activity',{activity:false});this._update();}.bind(this));if(!this.persistOnRefresh)l.onLeave(function(){m.unsubscribe(q);});}}};p.prototype._update=function(){d(['AvailableList'],function(q){var r=this.value;this.dirty();var s=m.getCachedProfileIDs(),t=s.filter(function(v){var w=m.getNow(v);return w.type===j.FRIEND;});t.sort(k.compare);var u=[];t.forEach(function(v){if(v==h.user)return;var w=q.get(v);if(!this.showOfflineUsers&&w!==q.ACTIVE)return;var x=m.getNow(v),y=x.additionalName;if(x.hasOwnProperty('searchTokens'))y=y!==null?y+" "+x.searchTokens.join(" "):x.searchTokens.join(" ");u.push({uid:v,text:x.name,tokens:y,localized_text:x.name,additional_text:x.additionalName,photo:x.thumbSrc,type:x.type});}.bind(this));if(u.length)this.addEntries(u);this.value=r;if(r)this.query(r);}.bind(this));};p.prototype.refreshData=function(){d(['AvailableList'],function(q){q.update();}.bind(this));};e.exports=p;});
__d("ChatSidebarHeader.react",["React","cx"],function(a,b,c,d,e,f){var g=b('React'),h=b('cx'),i=g.createClass({displayName:'ReactChatSidebarHeader',render:function(){return (g.DOM.div({className:"_55ob"},g.DOM.div({className:"_55oc"},this.props.name)));}});e.exports=i;});
__d("ChatSidebarUser.react",["ChatFavoriteList","WebMessengerPermalinkConstants","ChatConfig","React","ChatSidebarItem.react"],function(a,b,c,d,e,f){var g=b('ChatFavoriteList'),h=b('WebMessengerPermalinkConstants'),i=b('ChatConfig'),j=b('React'),k=b('ChatSidebarItem.react'),l=j.createClass({displayName:'ChatSidebarUser',render:function(){var m=h.getURIPathForIDOrVanity(this.props.userID),n=g.isFavored(this.props.userID),o=function(){g.toggleID(this.props.userID);}.bind(this),p=i.get('divebar_favorite_list',0)?n:undefined;return (k({href:{url:m},imageSize:this.props.imageSize,images:this.props.image,litestandSidebar:this.props.litestandSidebar,isAdded:p,showEditButton:g.isEditMode(),name:this.props.name,onEditClick:o,status:this.props.status,birthday:this.props.birthday,statusTime:this.props.statusTime,context:this.props.context}));}});e.exports=l;});
__d("ChatTypeaheadView",["BucketedTypeaheadView","ChatConfig","ChatTypeaheadConstants","Env","MercuryThreadSearchUtils","arrayContains","fbt","tx"],function(a,b,c,d,e,f){var g=b('BucketedTypeaheadView'),h=b('ChatConfig'),i=b('ChatTypeaheadConstants'),j=b('Env'),k=b('MercuryThreadSearchUtils'),l=b('arrayContains'),m=b('fbt'),n=b('tx'),o=h.get('divebar_typeahead_group_fof',0);for(var p in g)if(g.hasOwnProperty(p))r[p]=g[p];var q=g===null?null:g.prototype;r.prototype=Object.create(q);r.prototype.constructor=r;r.__superConstructor__=g;function r(s,t){g.call(this,s,t);this.typeObjects={};this.typeObjectsOrder=[];this.typeObjects[i.NON_FRIEND_TYPE]={uid:i.NON_FRIEND_TYPE,type:i.HEADER_TYPE,text:"AMIGOS DE AMIGOS"};this.typeObjectsOrder.push(i.NON_FRIEND_TYPE);this.typeObjects[i.THREAD_TYPE]={uid:i.THREAD_TYPE,type:i.HEADER_TYPE,text:"CONVERSACIONES DEL GRUPO"};this.typeObjectsOrder.push(i.THREAD_TYPE);this.typeObjects[i.FB4C_TYPE]={uid:i.FB4C_TYPE,type:i.HEADER_TYPE,text:"CO-WORKERS"};this.typeObjectsOrder.push(i.FB4C_TYPE);this.typeObjects[i.FRIEND_TYPE]={disabled:true,uid:i.FRIEND_TYPE,type:i.HEADER_TYPE,text:"AMIGOS"};this.typeObjectsOrder.push(i.FRIEND_TYPE);}r.prototype.buildBuckets=function(s,t){if(o){t=t.reverse();t=t.filter(function(u){var v=u.render_type||u.type;if(v==='thread'){var w='fbid:'+j.user;if(!l(u.mercury_thread.participants,w))return false;var x=u.participants_to_render.some(function(z){return k.queryMatchesName(s,z.name);}),y=k.queryMatchesName(s,u.mercury_thread.name);if(!x&&!y)return false;}return true;});}t=q.buildBuckets.call(this,s,t);if(!o)t=t.filter(function(u){return u&&!u.disabled;});return t;};r.prototype.getDefaultIndex=function(s){if(!o)return q.getDefaultIndex.call(this,s);if(s.length===0)return -1;var t=s.length-1;while(!this.isHighlightable(s[t])&&t>=0)t--;return t;};e.exports=r;});
__d("ChatBehavior",["Arbiter","AvailableList","AvailableListConstants","ChatConfig","copyProperties","MercuryConstants","ChatSidebarCalloutData"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('AvailableList'),i=b('AvailableListConstants'),j=b('ChatConfig'),k=b('copyProperties'),l=b('MercuryConstants').ChatNotificationConstants,m=b('ChatSidebarCalloutData').isShown,n=h.getWebChatNotification(),o=m,p=true,q=k(new g(),{ON_CHANGED:'changed',notifiesUserMessages:function(){return n!==l.NO_USER_MESSAGE_NOTIFICATION;},ignoresRemoteTabRaise:function(){return o;},showsTabUnreadUI:function(){if(j.get('web_messenger_suppress_tab_unread'))return p;return true;}});function r(){q.inform(q.ON_CHANGED);}h.subscribe(i.ON_CHAT_NOTIFICATION_CHANGED,function(){var s=n,t=h.getWebChatNotification();n=t;if(s!=t)r();});g.subscribe('chat/set_does_page_occlude_tabs',function(s,t){o=!!t;r();});g.subscribe('chat/set_show_tab_unread_ui',function(s,t){p=!!t;r();});e.exports=q;});
__d("ChatSidebarSheet",["function-extensions","ArbiterMixin","BlackbirdUpsell","ChannelConnection","ChannelConstants","ChatBehavior","ChatConfig","ChatVisibility","CSS","DOM","Event","JSLogger","PresencePrivacy","React","XUIButton.react","copyProperties","csx","cx","fbt","mixin","tx"],function(a,b,c,d,e,f){b('function-extensions');var g=b('ArbiterMixin'),h=b('BlackbirdUpsell'),i=b('ChannelConnection'),j=b('ChannelConstants'),k=b('ChatBehavior'),l=b('ChatConfig'),m=b('ChatVisibility'),n=b('CSS'),o=b('DOM'),p=b('Event'),q=b('JSLogger'),r=b('PresencePrivacy'),s=b('React'),t=b('XUIButton.react'),u=b('copyProperties'),v=b('csx'),w=b('cx'),x=b('fbt'),y=b('mixin'),z=b('tx'),aa=q.create('sidebar_sheet');function ba(ha){switch(ha){case j.HINT_AUTH:return "Tu sesi\u00f3n expir\u00f3. Por favor inicia sesi\u00f3n de nuevo.";case j.HINT_CONN:return z._("El {Chat} de Facebook no est\u00e1 disponible por el momento.",{Chat:"Chat"});case j.HINT_MAINT:return z._("El {Chat} de Facebook no est\u00e1 disponible por mantenimiento.",{Chat:"Chat"});default:return z._("El {Chat} de Facebook no est\u00e1 disponible por el momento.",{Chat:"Chat"});}}function ca(ha){var ia;if(ha===null){ia="No es posible conectar con el chat. Comprueba tu conexi\u00f3n a Internet.";}else if(ha>l.get('warning_countdown_threshold_msec')){var ja=o.create('a',{href:'#',className:'fbChatReconnectLink'},"Int\u00e9ntalo de nuevo");ia=o.tx._("No es posible conectar con el chat. {try-again-link}",{'try-again-link':ja});}else if(ha>1000){ia=z._("No es posible conectar con el chat. Nuevo intento de conexi\u00f3n en {seconds} segundos...",{seconds:Math.floor(ha/1000)});}else ia="No es posible conectar con el chat. Volviendo a conectar...";return ia;}var da=y(g);for(var ea in da)if(da.hasOwnProperty(ea))ga[ea]=da[ea];var fa=da===null?null:da.prototype;ga.prototype=Object.create(fa);ga.prototype.constructor=ga;ga.__superConstructor__=da;function ga(ha){this._root=ha;this._litestandOffline=o.scry(ha,"._52d2");this._message=o.find(ha,'div.fbChatSidebarMessage div.message');i.subscribe([i.CONNECTED,i.SHUTDOWN,i.RECONNECTING],this._handleConnectionChange.bind(this));i.subscribe([i.MUTE_WARNING,i.UNMUTE_WARNING],this._render.bind(this));r.subscribe('privacy-user-presence-changed',this._render.bind(this));k.subscribe(k.ON_CHANGED,this._render.bind(this));this._render();}ga.prototype._handleConnectionChange=function(ha,ia){this._channelStatus=ha;this._channelData=ia;this._render();};ga.prototype._renderChannelDisconnect=function(){if(this._channelStatus===i.SHUTDOWN){return o.setContent(this._message,ba(this._channelData));}else if(this._channelStatus===i.RECONNECTING){var ha=this._channelData;o.setContent(this._message,ca(ha));if(ha>1000){if(ha>l.get('warning_countdown_threshold_msec'))this._warningMsgEventListener=p.listen(this._message,'click',function(event){if(n.hasClass(event.getTarget(),'fbChatReconnectLink')){i.reconnect();return false;}});this._showWarningTimeout=setTimeout(this._handleConnectionChange.bind(this,i.RECONNECTING,ha-1000),1000,false);}}};ga.prototype._renderOffline=function(){if(this._isLitestand)return;if(this._litestandOffline&&this._litestandOffline.length)this._renderLitestandOffline();var ha='fbChatGoOnlineLink',ia="Activar el chat",ja=o.create('a',{href:'#',className:ha},ia),ka=o.tx._("{=Go online} para ver quien est\u00e1 disponible.",{'=Go online':ja});o.setContent(this._message,ka);this._goOnlineEventListener=p.listen(this._message,'click',function(event){if(n.hasClass(event.getTarget(),ha)){aa.log('sidebar_go_online');m.goOnline();return false;}});};ga.prototype._renderLitestandOffline=function(){this._litestandOffline=this._litestandOffline[0];this._isLitestand=true;if(l.get('litestand_blended_sidebar')){s.renderComponent(t({className:"_52cx _5d9x",href:{url:'#'},label:"Activar el chat",onClick:function(){aa.log('sidebar_go_online');m.goOnline();}}),this._litestandOffline);this._litestandOffline=null;}else{s.renderComponent(s.DOM.a({className:"_52cx _52i7",href:"#",onClick:function(){aa.log('sidebar_go_online');m.goOnline();}},s.DOM.i({className:"_52c_"}),s.DOM.div({className:"_52cz"},s.DOM.div({className:"_52c-"},s.DOM.i({className:"_52d1"}),s.DOM.div({className:"_52cy"},o.tx._("Activar el chat")))),s.DOM.i({className:"_52d0"}),s.DOM.div({className:"_4_vf",'data-hover':"tooltip",'data-tooltip-alignh':"center",'data-tooltip-position':"right",'aria-label':"Activar el chat"})),this._litestandOffline);this._litestandOffline=null;}};ga.prototype._renderBlackbirdUpsell=function(){o.setContent(this._message,h.getOfflineContent());};ga.prototype._renderBlackbird=function(ha){o.setContent(this._message,h.getBlackbirdContent(ha));};ga.prototype._clear=function(){if(this._showWarningTimeout){clearTimeout(this._showWarningTimeout);this._showWarningTimeout=null;}if(this._warningMsgEventListener){this._warningMsgEventListener.remove();this._warningMsgEventListener=null;}if(this._goOnlineEventListener){this._goOnlineEventListener.remove();this._goOnlineEventListener=null;}n.removeClass(this._root,'upsell');n.removeClass(this._root,'offline');n.removeClass(this._root,'blackbird');n.removeClass(this._root,'error');n.removeClass(this._root,'notice');o.empty(this._message);};ga.prototype._render=function(){this._clear();if(h.shouldShow()){if(m.hasBlackbirdEnabled()){var ha=m.isOnline()?'blackbird':'upsell';n.addClass(this._root,ha);this._renderBlackbird(r.getVisibility());}else if(!m.isOnline()){n.addClass(this._root,'upsell');this._renderBlackbirdUpsell();}}else if(!m.isOnline()){n.addClass(this._root,'offline');this._renderOffline();}else if(i.disconnected()){n.addClass(this._root,'error');this._renderChannelDisconnect();}else if(!k.notifiesUserMessages()){n.addClass(this._root,'notice');var ia;if(l.get('litestand_blended_sidebar')){ia="Las alertas est\u00e1n desactivadas";}else ia="Las alertas est\u00e1n desactivadas mientras usas otro cliente para chatear.";o.setContent(this._message,ia);}this.inform('updated');};u(ga.prototype,{_channelStatus:null,_channelData:null,_showWarningTimeout:null,_warningMsgEventListener:null,_goOnlineEventListener:null});e.exports=ga;});
__d("FBDesktopPlugin",["CacheStorage","DOM","Env","FBDesktopDetect","URI","Style"],function(a,b,c,d,e,f){var g=b('CacheStorage'),h=b('DOM'),i=b('Env'),j=b('FBDesktopDetect'),k=b('URI'),l=b('Style'),m=new g('localstorage','_socialfox_'),n={_plugin:'_not_checked',arbiterInform:function(o,p){var q=JSON.stringify({name:o,payload:p});this._transmitCommand('arbiterinform',q);},bringToFront:function(){this._transmitCommand('bringtofront');},dock:function(){this._transmitCommand('dock');},getPlugin:function(){if(this._plugin==='_not_checked'){this._plugin=null;if(j.isPluginInstalled()){var o=h.create('object',{id:'kiwi_plugin',type:j.mimeType});l.set(o,'width',0);l.set(o,'height',0);var p=h.create('div',{},o);l.set(p,'width',0);l.set(p,'height',0);document.body.appendChild(p);this._plugin=o;}}return this._plugin;},getUserID:function(){var o=this.getPlugin();return o&&'getUserID' in o&&o.getUserID();},getVersion:function(){var o=this.getPlugin();return o&&'getVersion' in o&&o.getVersion();},isAppRunning:function(){var o=this.getPlugin();return o&&'isAppRunning' in o&&o.isAppRunning();},launchApp:function(){var o=this.getPlugin();return o&&'launchApp' in o&&o.launchApp();},login:function(o,p){if(p&&o&&o.length>0){var q=this.getPlugin();if(q){this._transmitCommand('relogin\n'+o+'\n'+p);return;}}},logout:function(o){o=o||"0";var p=this.getPlugin();if(p)p.logout(o);},recheck:function(){if(this._plugin===null)this._plugin='_not_checked';},shouldSuppressBeeper:function(){return this.isAppRunning();},shouldSuppressMessages:function(){if(m&&m.get('connected'))return true;var o=this.getUserID();if(o){return o===i.user;}else return this.isAppRunning();},shouldSuppressSidebar:function(){var o=this.getPlugin(),p=o&&'isAppDocked' in o&&o.isAppDocked(),q=m&&m.get('active')==='true';return p||q;},transferAuthToken:function(o,p){if(o&&o.length>0){var q=this.getPlugin();if(q){q.setAccessToken(o,p);var r=setInterval(function(){q.setAccessToken(o,p);},500);setTimeout(function(){clearInterval(r);},10*1000);}}if(this.redirectHome)window.location.href=k().setPath().toString();},_transmitCommand:function(o,p){p=p||'';var q=this.getPlugin();if(q&&'transmitCommand' in q)q.transmitCommand(o,p);}};e.exports=n;});
__d("ChatSidebar",["ChatOrderedList","ChatTypeaheadBehavior","ChatTypeaheadCore","ChatTypeaheadDataSource","ChatTypeaheadRenderer","ChatTypeaheadView","Typeahead","Arbiter","ArbiterMixin","AsyncRequest","AsyncSignal","BlendedChatSidebar","Bootloader","Chat","ChatConfig","ChatHovercard","ChatImpressionLogger","ChatOptions","ChatSidebarSheet","CSS","DOM","DOMDimensions","Event","FBDesktopPlugin","JSLogger","JSXDOM","KeyEventController","OrderedFriendsList","Parent","PresencePrivacy","ScrollableArea","Style","UserAgent","ViewportBounds","copyProperties","createArrayFrom","csx","cx","debounce","emptyFunction","ge"],function(a,b,c,d,e,f){b('ChatOrderedList');b('ChatTypeaheadBehavior');b('ChatTypeaheadCore');b('ChatTypeaheadDataSource');b('ChatTypeaheadRenderer');b('ChatTypeaheadView');b('Typeahead');var g=b('Arbiter'),h=b('ArbiterMixin'),i=b('AsyncRequest'),j=b('AsyncSignal'),k=b('BlendedChatSidebar'),l=b('Bootloader'),m=b('Chat'),n=b('ChatConfig'),o=b('ChatHovercard'),p=b('ChatImpressionLogger'),q=b('ChatOptions'),r=b('ChatSidebarSheet'),s=b('CSS'),t=b('DOM'),u=b('DOMDimensions'),v=b('Event'),w=b('FBDesktopPlugin'),x=b('JSLogger'),y=b('JSXDOM'),z=b('KeyEventController'),aa=b('OrderedFriendsList'),ba=b('Parent'),ca=b('PresencePrivacy'),da=b('ScrollableArea'),ea=b('Style'),fa=b('UserAgent'),ga=b('ViewportBounds'),ha=b('copyProperties'),ia=b('createArrayFrom'),ja=b('csx'),ka=b('cx'),la=b('debounce'),ma=b('emptyFunction'),na=b('ge'),oa,pa=false,qa=false,ra=false,sa=false,ta=false,ua=false,va,wa,xa,ya,za,ab=null,bb,cb,db,eb,fb,gb,hb=28,ib=38,jb=x.create('chat_sidebar');function kb(){if(cb)return;s.removeClass(document.documentElement,'sidebarMode');if(!sa||!tb.isVisible()){g.inform('reflow');return;}ra=false;ab=null;va.hide();ya.getCore().reset();s.hide(wa);jb.rate('sidebar_hide',sa);tb.inform('sidebar/hide',tb);g.inform('sidebar/hide',tb);g.inform('reflow');}function lb(){var ub=tb.shouldShowSidebar();s.conditionClass(document.documentElement,'sidebarCapable',ub);if(tb.isEnabled()&&ub){ob();var vb;if(bb){var wb=s.hasClass(wa,"_4w59");if(wb)return;gb=gb||t.find(wa,"._50g0");if(bb.has_favorites_editing)fb=fb||t.scry(wa,"._52s9")[0];vb=[gb];}else vb=ia(wa.childNodes);var xb=nb(vb),yb=va.getItemHeight()||32,zb=va.getPaddingOffset()||8,ac;if(cb){if(cb.isExpanded()){zb=zb+hb;if(bb&&bb.always_show_one_see_more)zb+=yb;}if(!m.isOnline())zb+=ib;var bc=Math.floor(va.getItemPadding()/2);ac=Math.floor((xb-zb+bc)/yb);if(!va.isVisible())ea.set(oa,'height',xb+'px');}else{ac=Math.floor((xb-zb)/(yb+1));ea.set(oa,'height',xb+'px');}va.setNumTopFriends(ac);var cc=Math.floor((xb-zb)/yb);if(qb())cc=(cc-2)>0?cc-2:0;ya.getData().setMaxResults(cc);tb.inform('sidebar/resized',tb);g.inform('sidebar/resized',tb);g.inform('reflow');}else kb();if(!sa){sb();sa=true;}ab=null;}function mb(){if(ya&&tb.isVisible())ya.getCore().getElement().focus();}function nb(ub){if(!ub)if(bb){gb=gb||t.find(wa,"._50g0");ub=[gb];}else ub=ia(wa.childNodes);var vb=za.height;if(cb&&db)vb-=db.getFullHeight();ub.forEach(function(wb){if(wb&&wb!==oa)vb-=u.getElementDimensions(wb).height;});if(eb)vb-=eb.getOffset();return Math.max(0,vb);}function ob(){if(tb.isVisible())return;ra=true;ab=null;s.show(wa);s.addClass(document.documentElement,'sidebarMode');va.show();jb.rate('sidebar_show',sa);tb.inform('sidebar/show',tb);g.inform('sidebar/show',tb);}function pb(){q.setSetting('sidebar_mode',tb.isEnabled(),'sidebar');new i('/ajax/chat/settings.php').setHandler(ma).setErrorHandler(ma).setData({sidebar_mode:tb.isEnabled()}).setAllowCrossPageTransition(true).send();}function qb(){return n.get('divebar_typeahead_group_fof',0);}function rb(){return aa.getList().length<=n.get('sidebar.min_friends');}function sb(){var ub=true;if(!tb.isEnabled()){jb.log('state_not_enabled');ub=false;}if(!tb.isViewportCapable()){jb.log('state_not_shown_viewport');ub=false;}if(qa){jb.log('state_not_shown_hidden');ub=false;}if(rb()){jb.log('state_not_shown_num_friends');ub=false;}if(w.shouldSuppressSidebar()){jb.log('state_not_shown_fbdesktop');ub=false;}jb.log(ub?'state_shown':'state_not_shown');}var tb={init:function(ub,vb,wb,xb){tb.init=ma;ta=true;wa=ub;va=vb;ya=wb;xa=xb;oa=t.find(ub,'div.fbChatSidebarBody');cb=xb&&xb.ls_module;bb=xb&&xb.ls_config;if(cb){g.subscribe('ViewportSizeChange',function(){g.inform('ChatOrderedList/itemHeightChange');lb();});g.subscribe('Sidebar/BookmarksHeightChange',lb);l.loadModules(['LitestandSidebarBookmarksDisplay'],function(bc){db=bc;});}else v.listen(window,'resize',lb);z.registerKey('q',function(event){if(ra){var bc=null;if(gb){bc=t.scry(gb,'.inputsearch')[0];}else bc=t.scry(ub,'.inputsearch')[0];if(bc){bc.focus();event.prevent();}}});new o(vb);var yb=new r(ub);yb.subscribe('updated',lb);g.subscribe('sidebar/invalidate',lb);vb.setScrollContainer(ba.byClass(vb.getRoot(),'uiScrollableAreaWrap'));vb.subscribe(['render','show','hide'],la(function(bc){if(bc==='render'&&!ua){ua=true;tb.inform('sidebar/chatRendered',null,g.BEHAVIOR_PERSISTENT);}var cc=vb.getRoot(),dc=da.getInstance(cc);dc&&dc.adjustGripper();}));vb.subscribe(['editStart','editEnd'],function(bc){s.conditionClass(ya.getView().element,"_4-d6",bc=='editStart');});if(fa.firefox()>=17)v.listen(window,'storage',function(bc){if(bc.key=='_socialfox_active'&&bc.oldValue!=bc.newValue)lb();});g.subscribe('chat/option-changed',function(bc,cc){if(cc.name=="sidebar_mode"){pa=!!q.getSetting('sidebar_mode');lb();}});wb.getCore().subscribe('sidebar/typeahead/active',tb.updateOnActiveTypeahead);wb.subscribe('reset',function(){if(!wb.getCore().getValue()&&!va.isVisible())tb.updateOnActiveTypeahead(null,false);});if(cb){wb.getCore().subscribe('sidebar/typeahead/preActive',function(bc,cc){if(pa&&ya.getView().isVisible()){g.inform(bc,cc);}else lb();});}else g.subscribe('buddylist-nub/initialized',function(bc,cc){v.listen(cc.getButton(),'click',function(event){var dc=qa;qa=false;tb.enable();var ec=tb.shouldShowSidebar();qa=dc&&!ec;return !ec;});});pa=!!q.getSetting('sidebar_mode');fa.ie()&&v.listen(ub,'click',function(bc){if(ba.byClass(bc.getTarget(),"_57du"))mb();});ca.subscribe('privacy-user-presence-changed',lb);lb();p.init(va);if(!cb)ga.addRight(tb.getVisibleWidth);tb.inform('sidebar/initialized',tb,g.BEHAVIOR_PERSISTENT);g.inform('sidebar/initialized',tb,g.BEHAVIOR_PERSISTENT);if(n.get('litestand_blended_sidebar')){var zb=t.find(ub,"._5fhf");eb=new k(zb);eb.subscribe('resized',lb);}if(n.get('chat_sidebar_load_log')){var ac={loaded:true,session_token:xb.session_token};new j('/ajax/chat/sidebar_load_log.php',ac).send();}},updateOnActiveTypeahead:function(ub,vb){if(!ra)return;if(vb){va.hide();if(cb){s.addClass(wa,"_5384");var wb=nb();if(fb)wb+=u.getElementDimensions(fb).height;ea.set(oa,'height',wb+'px');}}else{va.show();if(cb){ea.set(oa,'height','auto');s.removeClass(wa,"_5384");g.inform('sidebar/typeahead/active',false);lb();}else lb();}},isInitialized:function(){return sa;},disable:function(){if(!tb.isEnabled())return;pa=false;pb();kb();},enable:function(){if(tb.isEnabled())return;pa=true;pb();lb();mb.defer();},forceEnsureLoaded:function(){if(ta)return;if(na('pagelet_sidebar'))return;d(['UIPagelet'],function(ub){var vb=y.div({id:"pagelet_sidebar"});t.appendContent(document.body,vb);ub.loadFromEndpoint('SidebarPagelet','pagelet_sidebar');});ta=true;},ensureLoaded:function(){if(!pa)return;tb.forceEnsureLoaded();},hide:function(){if(qa)return;qa=true;kb();},unhide:function(){if(!qa)return;qa=false;lb();},getBody:function(){return oa;},getRoot:function(){return wa;},getVisibleWidth:function(){if(!ra||!wa)return 0;if(ab===null)ab=wa.offsetWidth;return ab;},isEnabled:function(){return pa;},isViewportCapable:function(){za=u.getViewportWithoutScrollbarDimensions();if(cb)return true;var ub=n.get('sidebar.minimum_width');return za.width>ub;},shouldShowSidebar:function(){var ub=tb.isViewportCapable();return cb||(ub&&!qa&&(!rb()||n.get('litestand_blended_sidebar',false))&&!w.shouldSuppressSidebar());},isVisible:function(){return ra;},resize:lb,toggle:function(){if(cb){cb.toggle();}else tb.isEnabled()?tb.disable():tb.enable();},isLitestandSidebar:function(){return !!cb;}};ha(tb,h);e.exports=tb;});
__d("legacy:ChatTypeaheadBehavior",["ChatTypeaheadBehavior"],function(a,b,c,d){var e=b('ChatTypeaheadBehavior');if(!a.TypeaheadBehaviors)a.TypeaheadBehaviors={};a.TypeaheadBehaviors.chatTypeahead=function(f){f.enableBehavior(e);};},3);
__d("Dock",["function-extensions","Event","shield","WebMessengerWidthControl","Arbiter","ArbiterMixin","ChatQuietLinks","CSS","DataStore","DOM","Parent","Style","Toggler","Vector","copyProperties","csx","emptyFunction","ge"],function(a,b,c,d,e,f){b('function-extensions');var g=b('Event'),h=b('shield');b('WebMessengerWidthControl');var i=b('Arbiter'),j=b('ArbiterMixin'),k=b('ChatQuietLinks'),l=b('CSS'),m=b('DataStore'),n=b('DOM'),o=b('Parent'),p=b('Style'),q=b('Toggler'),r=b('Vector'),s=b('copyProperties'),t=b('csx'),u=b('emptyFunction'),v=b('ge');function w(){}s(w,j,{MIN_HEIGHT:140,INITIAL_FLYOUT_HEIGHT_OFFSET:10,init:function(x){this.init=u;this.rootEl=x;this.calculateViewportDimensions();this.calculateFlyoutHeightOffset();k.removeEmptyHrefs(this.rootEl);g.listen(x,'click',this._onClick.bind(this));g.listen(window,'resize',this._onWindowResize.bind(this));q.subscribe(['show','hide'],function(y,z){var aa=z.getActive();if(!n.contains(x,aa))return;if(l.hasClass(aa,'fbNub')){this.notifyNub(aa,y);if(y==='show')this._resizeNubFlyout(aa);}else{var ba=o.byClass(aa,'fbNubFlyout');if(ba)l.conditionClass(ba,'menuOpened',y==='show');}}.bind(this));this.inform('init',{},i.BEHAVIOR_PERSISTENT);},calculateViewportDimensions:function(){return (this.viewportDimensions=r.getViewportDimensions());},calculateFlyoutHeightOffset:function(){this.flyoutHeightOffset=this.INITIAL_FLYOUT_HEIGHT_OFFSET+r.getElementDimensions(this.rootEl).y;var x=v('blueBar');if(x){var y=p.isFixed(x)?'viewport':'document';this.flyoutHeightOffset+=r.getElementPosition(x,y).y+r.getElementDimensions(x).y;}},toggle:function(x){var y=this._findFlyout(x);if(!y)return;this.subscribe('init',function(){q.toggle(x);});},show:function(x){this.subscribe('init',function(){q.show(x);});},showNub:function(x){l.show(x);},hide:function(x){this.subscribe('init',function(){var y=q.getInstance(x);n.contains(x,y.getActive())&&y.hide();});},hideNub:function(x){l.hide(x);this.hide(x);},setUseMaxHeight:function(x,y){l.conditionClass(x,'maxHeight',y!==false);this._resizeNubFlyout(x);},_resizeNubFlyout:function(x){var y=this._findFlyout(x);if(!y||!(l.hasClass(x,'openToggler')||l.hasClass(x,'opened')))return;var z=n.find(y,'div.fbNubFlyoutOuter'),aa=n.find(z,'div.fbNubFlyoutInner'),ba=n.find(aa,'div.fbNubFlyoutBody'),ca=ba.scrollTop,da=ba.offsetHeight;p.set(ba,'height','auto');var ea=r.getElementDimensions(y),fa=r.getElementDimensions(ba),ga=this.getMaxFlyoutHeight(x);p.set(y,'max-height',ga+'px');p.set(z,'max-height',ga+'px');ea=r.getElementDimensions(y);var ha=r.getElementDimensions(aa),ia=ha.y-fa.y,ja=ea.y-ia,ka=parseInt(ba.style.height||ba.clientHeight,10),la=ja!==ka;if(ea.y>ia&&la)p.set(ba,'height',ja+'px');l.removeClass(y,'swapDirection');var ma=r.getElementPosition(y).x;l.conditionClass(y,'swapDirection',function(){if(ma<0)return true;return (ma+ea.x>this.viewportDimensions.x);}.bind(this)());if(la&&ca+da>=fa.y){ba.scrollTop=ba.scrollHeight;}else ba.scrollTop=ca;this.notifyNub(x,'resize');},getMaxFlyoutHeight:function(x){var y=this._findFlyout(x),z=r.getElementPosition(y,'viewport'),aa=r.getElementDimensions(y),ba=Math.max(this.MIN_HEIGHT,this.viewportDimensions.y-this.flyoutHeightOffset)-(this.viewportDimensions.y-z.y-aa.y);return Math.max(ba,0);},resizeAllFlyouts:function(){var x=n.scry(this.rootEl,"div._50-v.openToggler");x=x.concat(n.scry(this.rootEl,"div._50-v.opened"));var y=x.length;while(y--)this._resizeNubFlyout(x[y]);},_onClick:function(event){var x=event.getTarget(),y=o.byClass(x,'fbNub');if(y){if(o.byClass(x,'fbNubFlyoutTitlebar')){var z=o.byTag(x,'a'),aa=x.nodeName=='INPUT'&&x.getAttribute('type')=='submit';if(!z&&!aa){this.hide(y);return false;}}this.notifyNub(y,'click');}},_onWindowResize:function(event){this.calculateViewportDimensions();this.resizeAllFlyouts();},_findFlyout:function(x){return l.hasClass(x,'fbNubFlyout')?x:n.scry(x,'div.fbNubFlyout')[0]||null;},registerNubController:function(x,y){m.set(x,'dock:nub:controller',y);y.subscribe('nub/button/content-changed',h(this.inform,this,'resize',x));y.subscribe('nub/flyout/content-changed',h(this._resizeNubFlyout,this,x));},unregisterNubController:function(x){m.remove(x,'dock:nub:controller');},notifyNub:function(x,y,z){var aa=m.get(x,'dock:nub:controller');aa&&aa.inform(y,z);}});e.exports=a.Dock||w;});
__d("NubController",["ArbiterMixin","Dock","copyProperties"],function(a,b,c,d,e,f){var g=b('ArbiterMixin'),h=b('Dock'),i=b('copyProperties');function j(){}i(j.prototype,g,{init:function(k){this.el=k;h.registerNubController(k,this);return this;},buttonContentChanged:function(){this.inform('nub/button/content-changed');},flyoutContentChanged:function(){this.inform('nub/flyout/content-changed');},hide:function(){h.hide(this.el);},show:function(){h.show(this.el);}});e.exports=j;});
__d("swfobject",["AsyncRequest","Bootloader","ControlledReferer","copyProperties","CSS","DOM","function-extensions","ge","htmlSpecialChars"],function(a,b,c,d,e,f){var g=b('AsyncRequest'),h=b('Bootloader'),i=b('ControlledReferer'),j=b('copyProperties'),k=b('CSS'),l=b('DOM');b('function-extensions');var m=b('ge'),n=b('htmlSpecialChars');if(typeof o=="undefined")var o={};if(typeof o.util=="undefined")o.util={};if(typeof o.SWFObjectUtil=="undefined")o.SWFObjectUtil={};o.SWFObject=function(u,v,w,x,y,z,aa,ba,ca,da){if(!document.getElementById)return;this.DETECT_KEY=da?da:'detectflash';this.skipDetect=o.util.getRequestParameter(this.DETECT_KEY);this.params={};this.variables={};this.attributes=[];this.fallback_html='';this.fallback_js_fcn=function(){};if(u)this.setAttribute('swf',u);if(v)this.setAttribute('id',v);if(w)this.setAttribute('width',w);if(x)this.setAttribute('height',x);this.installedVer=o.SWFObjectUtil.getPlayerVersion();if(y){if(!(y instanceof Array))y=[y];var ea;y.forEach(function(ha){ea=new o.PlayerVersion(ha.toString().split('.'));if(ea.major==this.installedVer.major){this.setAttribute('version',ea);return;}else if(!this.getAttribute('version')||ea.major<this.getAttribute('version').major)this.setAttribute('version',ea);}.bind(this));}if(!window.opera&&document.all&&this.installedVer.major>7)if(!o.unloadSet){o.SWFObjectUtil.prepUnload=function(){var ha=function(){},ia=function(){};window.attachEvent("onunload",o.SWFObjectUtil.cleanupSWFs);};window.attachEvent("onbeforeunload",o.SWFObjectUtil.prepUnload);o.unloadSet=true;}if(z)this.addParam('bgcolor',z);var fa=aa?aa:'high';this.addParam('quality',fa);this.setAttribute('useExpressInstall',false);this.setAttribute('doExpressInstall',false);var ga=(ba)?ba:window.location;this.setAttribute('xiRedirectUrl',ga);this.setAttribute('redirectUrl','');if(ca)this.setAttribute('redirectUrl',ca);this.setAttribute('useIframe',false);};o.SWFObject.ieWorkaroundApplied=false;o.SWFObject.ensureIEWorkaroundAttached=function(){if(!o.SWFObject.ieWorkaroundApplied&&document.attachEvent){o.SWFObject.ieWorkaroundApplied=true;document.attachEvent('onpropertychange',o.SWFObject.onDocumentPropertyChange);}};o.SWFObject.onDocumentPropertyChange=function(event){if(event.propertyName=="title"){var u=document.title;if(u!=null&&u.indexOf('#!')!=-1){u=u.substring(0,u.indexOf('#!'));document.title=u;}}};j(o.SWFObject.prototype,{useExpressInstall:function(u){this.xiSWFPath=!u?"/swf/expressinstall.swf":u;this.setAttribute('useExpressInstall',true);},setAttribute:function(u,v){this.attributes[u]=v;},getAttribute:function(u){return this.attributes[u]||"";},addParam:function(u,v){this.params[u]=v;},getParams:function(){return this.params;},addVariable:function(u,v){this.variables[u]=v;},getVariable:function(u){return this.variables[u]||"";},getVariables:function(){return this.variables;},getVariablePairs:function(){var u=[],v,w=this.getVariables();for(v in w)u[u.length]=v+"="+w[v];return u.join('&');},getSWFHTML:function(){var u,v,w;if(navigator.plugins&&navigator.mimeTypes&&navigator.mimeTypes.length){if(this.getAttribute("doExpressInstall")){this.addVariable("MMplayerType","PlugIn");this.setAttribute('swf',this.xiSWFPath);}v={type:'application/x-shockwave-flash',src:this.getAttribute('swf'),width:this.getAttribute('width'),height:this.getAttribute('height'),style:this.getAttribute('style')||'display: block;',id:this.getAttribute('id'),name:this.getAttribute('id')};var x=this.getParams();for(var y in x)v[y]=x[y];w=this.getVariablePairs();if(w)v.flashvars=w;u=t('embed',v,null);}else{if(this.getAttribute("doExpressInstall")){this.addVariable("MMplayerType","ActiveX");this.setAttribute('swf',this.xiSWFPath);}v={id:this.getAttribute('id'),classid:'clsid:D27CDB6E-AE6D-11cf-96B8-444553540000',width:this.getAttribute('width'),height:this.getAttribute('height'),style:this.getAttribute('style')||'display: block;'};var z=t('param',{name:'movie',value:this.getAttribute('swf')},null),x=this.getParams();for(var y in x)z+=t('param',{name:y,value:x[y]},null);w=this.getVariablePairs();if(w)z+=t('param',{name:'flashvars',value:w},null);u=t('object',v,z);}return u;},write:function(u){if(this.getAttribute('useExpressInstall')){var v=new o.PlayerVersion([6,0,65]);if(this.installedVer.versionIsValid(v)&&!this.installedVer.versionIsValid(this.getAttribute('version'))){this.setAttribute('doExpressInstall',true);this.addVariable("MMredirectURL",escape(this.getAttribute('xiRedirectUrl')));document.title=document.title.slice(0,47)+" - Flash Player Installation";this.addVariable("MMdoctitle",document.title);}}var w=(typeof u=='string')?document.getElementById(u):u;if(!w)return false;k.addClass(w,'swfObject');w.setAttribute('data-swfid',this.getAttribute('id'));if(this.skipDetect||this.getAttribute('doExpressInstall')||this.installedVer.versionIsValid(this.getAttribute('version'))){if(!this.getAttribute('useIframe')){o.SWFObject.ensureIEWorkaroundAttached();w.innerHTML=this.getSWFHTML();}else this._createIframe(w);return true;}else{if(this.getAttribute('redirectUrl')!="")document.location.replace(this.getAttribute('redirectUrl'));var x=this.getAttribute('version').major+'.'+this.getAttribute('version').minor+'.'+this.getAttribute('version').release+'.'+this.getAttribute('version').build,y=this.installedVer.major+'.'+this.installedVer.minor+'.'+this.installedVer.release+'.'+this.installedVer.build;this.fallback_js_fcn(y,x);w.innerHTML=this.fallback_html;}return false;},_createIframe:function(u){var v=l.create('iframe',{width:this.getAttribute('width'),height:this.getAttribute('height'),frameBorder:0});l.empty(u);u.appendChild(v);i.useFacebookRefererHtml(v,this.getSWFHTML(),this.getAttribute('iframeSource'));}});o.SWFObjectUtil.getPlayerVersion=function(){var u=new o.PlayerVersion([0,0,0,0]),v;if(navigator.plugins&&navigator.mimeTypes.length){for(var w=0;w<navigator.plugins.length;w++)try{var y=navigator.plugins[w];if(y.name=='Shockwave Flash'){v=new o.PlayerVersion(y.description.replace(/([a-zA-Z]|\s)+/,"").replace(/(\s+(r|d)|\s+b[0-9]+)/,".").split("."));if(typeof u=='undefined'||v.major>u.major||(v.major==u.major&&(v.minor>u.minor||(v.minor==u.minor&&(v.release>u.release||(v.release==u.release&&v.build>u.build))))))u=v;}}catch(x){}}else if(navigator.userAgent&&navigator.userAgent.indexOf("Windows CE")>=0){var z=1,aa=3;while(z)try{aa++;z=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+aa);u=new o.PlayerVersion([aa,0,0]);}catch(ba){z=null;}}else{try{var z=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7");}catch(ca){try{var z=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");u=new o.PlayerVersion([6,0,21]);z.AllowScriptAccess="always";}catch(da){if(u.major==6)return u;}try{z=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");}catch(ea){}}if(z!=null)u=new o.PlayerVersion(z.GetVariable("$version").split(" ")[1].split(","));}return u;};o.PlayerVersion=function(u){this.major=u[0]!=null?parseInt(u[0],10):0;this.minor=u[1]!=null?parseInt(u[1],10):0;this.release=u[2]!=null?parseInt(u[2],10):0;this.build=u[3]!=null?parseInt(u[3],10):0;};o.PlayerVersion.prototype.versionIsValid=function(u){if(this.major<u.major)return false;if(this.major>u.major)return true;if(this.minor<u.minor)return false;if(this.minor>u.minor)return true;if(this.release<u.release)return false;if(this.release>u.release)return true;if(this.build<u.build)return false;return true;};o.util={getRequestParameter:function(u){var v=document.location.search||document.location.hash;if(u==null)return v;if(v){var w=v.substring(1).split("&");for(var x=0;x<w.length;x++)if(w[x].substring(0,w[x].indexOf("="))==u)return w[x].substring((w[x].indexOf("=")+1));}return "";}};o.SWFObjectUtil.cleanupSWFs=function(){var u=document.getElementsByTagName("OBJECT");for(var v=u.length-1;v>=0;v--){u[v].style.display='none';for(var w in u[v])if(typeof u[v][w]=='function')u[v][w]=function(){};}};if(!document.getElementById&&document.all)document.getElementById=function(u){return document.all[u];};var p=o.util.getRequestParameter,q=o.SWFObject,r=o.SWFObject;o.spawn_flash_update_dialog=function(){new g().setURI('/ajax/flash_update_dialog.php').setMethod('GET').setReadOnly(true).send();};function s(u,v){var w=m(u),x=o.SWFObjectUtil.getPlayerVersion(),y;v.forEach(function(ba){ba=new o.PlayerVersion(ba.toString().split('.'));if(ba.major==x.major){y=ba;return;}else if(typeof y=='undefined'||ba.major<y.major)y=ba;}.bind(this));if(w&&x.major>0){var z=x.major+'.'+x.minor+'.'+x.release+'.'+x.build,aa=y.major+'.'+y.minor+'.'+y.release+'.'+y.build;l.setContent(w,l.tx._("Se requiere Flash {required-version} para ver este contenido. Tu versi\u00f3n actual es {current-version}. Baja el Flash Player m\u00e1s reciente.",{'required-version':aa,'current-version':z}));}}o.showFlashErrorDialog=function(u,v){h.loadModules(['ErrorDialog'],function(w){w.show(u,v);});};function t(u,v,w){var x=/^[A-Za-z0-9\-]+$/;if(!u.match(x))throw new Error('Invalid tag '+u);var y='<'+u;for(var z in v){if(!z.match(x))throw new Error('Invalid attr '+z);y+=' '+z+'="'+n(v[z])+'"';}if(w===null){return y+'/>';}else return y+'>'+w+'</'+u+'>';}e.exports=a.deconcept||o;});
__d("swfobject2",[],function(a,b,c,d,e,f){var g=function(){var h="undefined",i="object",j="Shockwave Flash",k="ShockwaveFlash.ShockwaveFlash",l="application/x-shockwave-flash",m="SWFObjectExprInst",n="onreadystatechange",o=window,p=document,q=navigator,r=false,s=[ka],t=[],u=[],v=[],w,x,y,z,aa=false,ba=false,ca,da,ea=true,fa=function(){var eb=typeof p.getElementById!=h&&typeof p.getElementsByTagName!=h&&typeof p.createElement!=h,fb=q.userAgent.toLowerCase(),gb=q.platform.toLowerCase(),hb=gb?/win/.test(gb):/win/.test(fb),ib=gb?/mac/.test(gb):/mac/.test(fb),jb=/webkit/.test(fb)?parseFloat(fb.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):false,kb=!+"\v1",lb=[0,0,0],mb=null;if(typeof q.plugins!=h&&typeof q.plugins[j]==i){mb=q.plugins[j].description;if(mb&&!(typeof q.mimeTypes!=h&&q.mimeTypes[l]&&!q.mimeTypes[l].enabledPlugin)){r=true;kb=false;mb=mb.replace(/^.*\s+(\S+\s+\S+$)/,"$1");lb[0]=parseInt(mb.replace(/^(.*)\..*$/,"$1"),10);lb[1]=parseInt(mb.replace(/^.*\.(.*)\s.*$/,"$1"),10);lb[2]=/[a-zA-Z]/.test(mb)?parseInt(mb.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0;}}else if(typeof o.ActiveXObject!=h)try{var ob=new ActiveXObject(k);if(ob){mb=ob.GetVariable("$version");if(mb){kb=true;mb=mb.split(" ")[1].split(",");lb=[parseInt(mb[0],10),parseInt(mb[1],10),parseInt(mb[2],10)];}}}catch(nb){}return {w3:eb,pv:lb,wk:jb,ie:kb,win:hb,mac:ib};}(),ga=function(){if(!fa.w3)return;if((typeof p.readyState!=h&&p.readyState=="complete")||(typeof p.readyState==h&&(p.getElementsByTagName("body")[0]||p.body)))ha();if(!aa){if(typeof p.addEventListener!=h)p.addEventListener("DOMContentLoaded",ha,false);if(fa.ie&&fa.win){p.attachEvent(n,function(){if(p.readyState=="complete"){p.detachEvent(n,arguments.callee);ha();}});if(o==top)(function(){if(aa)return;try{p.documentElement.doScroll("left");}catch(eb){setTimeout(arguments.callee,0);return;}ha();})();}if(fa.wk)(function(){if(aa)return;if(!/loaded|complete/.test(p.readyState)){setTimeout(arguments.callee,0);return;}ha();})();ja(ha);}}();function ha(){if(aa)return;try{var fb=p.getElementsByTagName("body")[0].appendChild(xa("span"));fb.parentNode.removeChild(fb);}catch(eb){return;}aa=true;var gb=s.length;for(var hb=0;hb<gb;hb++)s[hb]();}function ia(eb){if(aa){eb();}else s[s.length]=eb;}function ja(eb){if(typeof o.addEventListener!=h){o.addEventListener("load",eb,false);}else if(typeof p.addEventListener!=h){p.addEventListener("load",eb,false);}else if(typeof o.attachEvent!=h){ya(o,"onload",eb);}else if(typeof o.onload=="function"){var fb=o.onload;o.onload=function(){fb();eb();};}else o.onload=eb;}function ka(){if(r){la();}else ma();}function la(){var eb=p.getElementsByTagName("body")[0],fb=xa(i);fb.setAttribute("type",l);fb.setAttribute('style','visibility: hidden; position: absolute; top: -1000px;');var gb=eb.appendChild(fb);if(gb){var hb=0;(function(){if(typeof gb.GetVariable!=h){var ib=gb.GetVariable("$version");if(ib){ib=ib.split(" ")[1].split(",");fa.pv=[parseInt(ib[0],10),parseInt(ib[1],10),parseInt(ib[2],10)];}}else if(hb<10){hb++;setTimeout(arguments.callee,10);return;}gb=null;ma();})();}else ma();}function ma(){var eb=t.length;if(eb>0)for(var fb=0;fb<eb;fb++){var gb=t[fb].id,hb=t[fb].callbackFn,ib={success:false,id:gb};if(fa.pv[0]>0){var jb=wa(gb);if(jb)if(za(t[fb].swfVersion)&&!(fa.wk&&fa.wk<312)){bb(gb,true);if(hb){ib.success=true;ib.ref=na(gb);hb(ib);}}else if(t[fb].expressInstall&&oa()){var kb={};kb.data=t[fb].expressInstall;kb.width=jb.getAttribute("width")||"0";kb.height=jb.getAttribute("height")||"0";if(jb.getAttribute("class"))kb.styleclass=jb.getAttribute("class");if(jb.getAttribute("align"))kb.align=jb.getAttribute("align");var lb={},mb=jb.getElementsByTagName("param"),nb=mb.length;for(var ob=0;ob<nb;ob++)if(mb[ob].getAttribute("name").toLowerCase()!="movie")lb[mb[ob].getAttribute("name")]=mb[ob].getAttribute("value");pa(kb,lb,gb,hb);}else{qa(jb);if(hb)hb(ib);}}else{bb(gb,true);if(hb){var pb=na(gb);if(pb&&typeof pb.SetVariable!=h){ib.success=true;ib.ref=pb;}hb(ib);}}}}function na(eb){var fb=null,gb=wa(eb);if(gb&&gb.nodeName=="OBJECT")if(typeof gb.SetVariable!=h){fb=gb;}else{var hb=gb.getElementsByTagName(i)[0];if(hb)fb=hb;}return fb;}function oa(){return !ba&&za("6.0.65")&&(fa.win||fa.mac)&&!(fa.wk&&fa.wk<312);}function pa(eb,fb,gb,hb){ba=true;y=hb||null;z={success:false,id:gb};var ib=wa(gb);if(ib){if(ib.nodeName=="OBJECT"){w=ra(ib);x=null;}else{w=ib;x=gb;}eb.id=m;if(typeof eb.width==h||(!/%$/.test(eb.width)&&parseInt(eb.width,10)<310))eb.width="310";if(typeof eb.height==h||(!/%$/.test(eb.height)&&parseInt(eb.height,10)<137))eb.height="137";p.title=p.title.slice(0,47)+" - Flash Player Installation";var jb=fa.ie&&fa.win?"ActiveX":"PlugIn",kb="MMredirectURL="+o.location.toString().replace(/&/g,"%26")+"&MMplayerType="+jb+"&MMdoctitle="+p.title;if(typeof fb.flashvars!=h){fb.flashvars+="&"+kb;}else fb.flashvars=kb;if(fa.ie&&fa.win&&ib.readyState!=4){var lb=xa("div");gb+="SWFObjectNew";lb.setAttribute("id",gb);ib.parentNode.insertBefore(lb,ib);ib.style.display="none";(function(){if(ib.readyState==4){ib.parentNode.removeChild(ib);}else setTimeout(arguments.callee,10);})();}sa(eb,fb,gb);}}function qa(eb){if(fa.ie&&fa.win&&eb.readyState!=4){var fb=xa("div");eb.parentNode.insertBefore(fb,eb);fb.parentNode.replaceChild(ra(eb),fb);eb.style.display="none";(function(){if(eb.readyState==4){eb.parentNode.removeChild(eb);}else setTimeout(arguments.callee,10);})();}else eb.parentNode.replaceChild(ra(eb),eb);}function ra(eb){var fb=xa("div");if(fa.win&&fa.ie){fb.innerHTML=eb.innerHTML;}else{var gb=eb.getElementsByTagName(i)[0];if(gb){var hb=gb.childNodes;if(hb){var ib=hb.length;for(var jb=0;jb<ib;jb++)if(!(hb[jb].nodeType==1&&hb[jb].nodeName=="PARAM")&&!(hb[jb].nodeType==8))fb.appendChild(hb[jb].cloneNode(true));}}}return fb;}function sa(eb,fb,gb){var hb,ib=wa(gb);if(fa.wk&&fa.wk<312)return hb;if(ib){if(typeof eb.id==h)eb.id=gb;if(fa.ie&&fa.win){var jb="";for(var kb in eb)if(eb[kb]!=Object.prototype[kb])if(kb.toLowerCase()=="data"){fb.movie=eb[kb];}else if(kb.toLowerCase()=="styleclass"){jb+=' class="'+eb[kb]+'"';}else if(kb.toLowerCase()!="classid")jb+=' '+kb+'="'+eb[kb]+'"';var lb="";for(var mb in fb)if(fb[mb]!=Object.prototype[mb])lb+='<param name="'+mb+'" value="'+fb[mb]+'" />';ib.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+jb+'>'+lb+'</object>';u[u.length]=eb.id;hb=wa(eb.id);}else{var nb=xa(i);nb.setAttribute("type",l);for(var ob in eb)if(eb[ob]!=Object.prototype[ob])if(ob.toLowerCase()=="styleclass"){nb.setAttribute("class",eb[ob]);}else if(ob.toLowerCase()!="classid")nb.setAttribute(ob,eb[ob]);for(var pb in fb)if(fb[pb]!=Object.prototype[pb]&&pb.toLowerCase()!="movie")ta(nb,pb,fb[pb]);ib.parentNode.replaceChild(nb,ib);hb=nb;}}return hb;}function ta(eb,fb,gb){var hb=xa("param");hb.setAttribute("name",fb);hb.setAttribute("value",gb);eb.appendChild(hb);}function ua(eb){var fb=wa(eb);if(fb&&fb.nodeName=="OBJECT")if(fa.ie&&fa.win){fb.style.display="none";(function(){if(fb.readyState==4){va(eb);}else setTimeout(arguments.callee,10);})();}else fb.parentNode.removeChild(fb);}function va(eb){var fb=wa(eb);if(fb){for(var gb in fb)if(typeof fb[gb]=="function")fb[gb]=null;fb.parentNode.removeChild(fb);}}function wa(eb){var fb=null;try{fb=p.getElementById(eb);}catch(gb){}return fb;}function xa(eb){return p.createElement(eb);}function ya(eb,fb,gb){eb.attachEvent(fb,gb);v[v.length]=[eb,fb,gb];}function za(eb){var fb=fa.pv,gb=eb.split(".");gb[0]=parseInt(gb[0],10);gb[1]=parseInt(gb[1],10)||0;gb[2]=parseInt(gb[2],10)||0;return (fb[0]>gb[0]||(fb[0]==gb[0]&&fb[1]>gb[1])||(fb[0]==gb[0]&&fb[1]==gb[1]&&fb[2]>=gb[2]))?true:false;}function ab(eb,fb,gb,hb){if(fa.ie&&fa.mac)return;var ib=p.getElementsByTagName("head")[0];if(!ib)return;var jb=(gb&&typeof gb=="string")?gb:"screen";if(hb){ca=null;da=null;}if(!ca||da!=jb){var kb=xa("style");kb.setAttribute("type","text/css");kb.setAttribute("media",jb);ca=ib.appendChild(kb);if(fa.ie&&fa.win&&typeof p.styleSheets!=h&&p.styleSheets.length>0)ca=p.styleSheets[p.styleSheets.length-1];da=jb;}if(fa.ie&&fa.win){if(ca&&typeof ca.addRule==i)ca.addRule(eb,fb);}else if(ca&&typeof p.createTextNode!=h)ca.appendChild(p.createTextNode(eb+" {"+fb+"}"));}function bb(eb,fb){if(!ea)return;var gb=fb?"visible":"hidden";if(aa&&wa(eb)){wa(eb).style.visibility=gb;}else ab("#"+eb,"visibility:"+gb);}function cb(eb){var fb=/[\\\"<>\.;]/,gb=fb.exec(eb)!=null;return gb&&typeof encodeURIComponent!=h?encodeURIComponent(eb):eb;}var db=function(){if(fa.ie&&fa.win)window.attachEvent("onunload",function(){var eb=v.length;for(var fb=0;fb<eb;fb++)v[fb][0].detachEvent(v[fb][1],v[fb][2]);var gb=u.length;for(var hb=0;hb<gb;hb++)ua(u[hb]);for(var ib in fa)fa[ib]=null;fa=null;for(var jb in g)g[jb]=null;g=null;});}();return {registerObject:function(eb,fb,gb,hb){if(fa.w3&&eb&&fb){var ib={};ib.id=eb;ib.swfVersion=fb;ib.expressInstall=gb;ib.callbackFn=hb;t[t.length]=ib;bb(eb,false);}else if(hb)hb({success:false,id:eb});},getObjectById:function(eb){if(fa.w3)return na(eb);},embedSWF:function(eb,fb,gb,hb,ib,jb,kb,lb,mb,nb){var ob={success:false,id:fb};if(fa.w3&&!(fa.wk&&fa.wk<312)&&eb&&fb&&gb&&hb&&ib){bb(fb,false);ia(function(){gb+="";hb+="";var pb={};if(mb&&typeof mb===i)for(var qb in mb)pb[qb]=mb[qb];pb.data=eb;pb.width=gb;pb.height=hb;var rb={};if(lb&&typeof lb===i)for(var sb in lb)rb[sb]=lb[sb];if(kb&&typeof kb===i)for(var tb in kb)if(typeof rb.flashvars!=h){rb.flashvars+="&"+tb+"="+kb[tb];}else rb.flashvars=tb+"="+kb[tb];if(za(ib)){var ub=sa(pb,rb,fb);if(pb.id==fb)bb(fb,true);ob.success=true;ob.ref=ub;}else if(jb&&oa()){pb.data=jb;pa(pb,rb,fb,nb);return;}else bb(fb,true);if(nb)nb(ob);});}else if(nb)nb(ob);},switchOffAutoHideShow:function(){ea=false;},ua:fa,getFlashPlayerVersion:function(){return {major:fa.pv[0],minor:fa.pv[1],release:fa.pv[2]};},hasFlashPlayerVersion:za,createSWF:function(eb,fb,gb){if(fa.w3){return sa(eb,fb,gb);}else return undefined;},showExpressInstall:function(eb,fb,gb,hb){if(fa.w3&&oa())pa(eb,fb,gb,hb);},removeSWF:function(eb){if(fa.w3)ua(eb);},createCSS:function(eb,fb,gb,hb){if(fa.w3)ab(eb,fb,gb,hb);},addDomLoadEvent:ia,addLoadEvent:ja,getQueryParamValue:function(eb){var fb=p.location.search||p.location.hash;if(fb){if(/\?/.test(fb))fb=fb.split("?")[1];if(eb==null)return cb(fb);var gb=fb.split("&");for(var hb=0;hb<gb.length;hb++)if(gb[hb].substring(0,gb[hb].indexOf("="))==eb)return cb(gb[hb].substring((gb[hb].indexOf("=")+1)));}return "";},expressInstallCallback:function(){if(ba){var eb=wa(m);if(eb&&w){eb.parentNode.replaceChild(w,eb);if(x){bb(x,true);if(fa.ie&&fa.win)w.style.display="block";}if(y)y(z);}ba=false;}}};}();e.exports=g;});
__d("SoundPlayer",["Arbiter","ChatConfig","swfobject","swfobject2","URI","createArrayFrom"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('ChatConfig'),i=b('swfobject').SWFObject,j=b('swfobject2'),k=b('URI'),l=b('createArrayFrom'),m={},n=null,o=false,p='so_sound_player',q='/swf/SoundPlayer.swf?v=1',r='10.0.22.87',s=null,t=h.get('sound.useswfobject_2',false),u=h.get('sound.force_flash',false);function v(da){var ea=k(da);if(!ea.getDomain())return k().setPath(ea.getPath()).toString();return da;}function w(da){var ea=k(da).getPath();if(/\.mp3$/.test(ea))return 'audio/mpeg';if(/\.og[ga]$/.test(ea))return 'audio/ogg';return '';}function x(){if(!s&&!u){var da=document.createElement('audio');if(!da||!da.canPlayType)return null;da.setAttribute('preload','auto');document.body.appendChild(da);s=da;}return s;}function y(){var da=document[p]||window[p];if(da)if(!da.playSound&&da.length)da=da[0];return (da&&da.playSound&&da.loopSound)?da:null;}function z(){return o;}function aa(da,ea,fa){n={path:da,sync:ea,loop:fa};}function ba(){o=true;if(n){var da=y();if(n.loop){da.loopSound(n.path,n.sync);}else da.playSound(n.path,n.sync);}}var ca={init:function(da){da=l(da);var ea;for(var fa=0;fa<da.length;++fa){ea=da[fa];if(m[ea])return;}var ga=x();for(fa=0;ga&&fa<da.length;++fa){ea=da[fa];if(ga.canPlayType(ea)){m[ea]=true;return;}}m['audio/mpeg']=true;if(y())return;try{g.registerCallback(ba,['sound/player_ready','sound/ready']);var ia=document.createElement('div');ia.id='sound_player_holder';document.body.appendChild(ia);if(t){j.embedSWF(q,ia.id,'1px','1px',r,null,{swf_id:p},{allowscriptaccess:'always',wmode:'transparent'},null,function(ka){window[p]=ka.ref;g.inform('sound/player_ready');});}else{var ja=new i(q,p,'1px','1px',[r],'#ffffff');ja.addParam('allowscriptaccess','always');ja.addParam('wmode','transparent');ja.addVariable('swf_id',p);ja.fallback_html=' ';ja.write(ia.id);window[p]=ja;g.inform('sound/player_ready');}}catch(ha){}},play:function(da,ea){da=l(da);var fa=x(),ga,ha;for(var ia=0;fa&&ia<da.length;++ia){ga=da[ia];ha=w(ga);if(!fa.canPlayType(ha))continue;ca.init([ha]);fa.src=v(ga);if(ea){fa.setAttribute('loop','');}else fa.removeAttribute('loop');fa.play();return;}for(ia=0;ia<da.length;++ia){ga=v(da[ia]);ha=w(ga);if(ha!='audio/mpeg')continue;ca.init([ha]);var ja=y();if(!z()){aa(ga,true,ea);return;}else if(ja){if(ea){ja.loopSound(ga,true);}else ja.playSound(ga,true);return;}}},stop:function(da){da=l(da);for(var ea=0;ea<da.length;++ea){var fa=v(da[ea]),ga=x(),ha=y();if(ga&&ga.src==fa){ga.pause();ga.src=undefined;}else ha&&ha.stopSound(fa);}}};e.exports=ca;});
__d("SoundSynchronizer",["SoundPlayer","WebStorage","createArrayFrom"],function(a,b,c,d,e,f){var g=b('SoundPlayer'),h=b('WebStorage'),i=b('createArrayFrom'),j='fb_sounds_playing3';function k(){var o=h.getLocalStorage();if(o)try{var q=o[j];if(q){q=JSON.parse(q);if(Array.isArray(q))return q;}}catch(p){}return [];}function l(o){var p=h.getLocalStorage();if(p){var q=k();q.push(o);while(q.length>5)q.shift();try{p[j]=JSON.stringify(q);}catch(r){}}}function m(o){return k().some(function(p){return p===o;});}var n={play:function(o,p,q){o=i(o);p=p||(o[0]+Math.floor(Date.now()/1000));if(m(p))return;g.play(o,q);l(p);},isSupported:function(){return !!h.getLocalStorage();}};e.exports=n;});
__d("Sound",["SoundPlayer","SoundRPC","SoundSynchronizer","URI","UserAgent"],function(a,b,c,d,e,f){var g=b('SoundPlayer'),h=b('SoundRPC'),i=b('SoundSynchronizer'),j=b('URI'),k=b('UserAgent'),l=null,m={init:function(q){if(!l)g.init(q);},play:function(q,r,s){if(l){h.playRemote(l.contentWindow,q,r,false);}else h.playLocal(q,r,s);},stop:function(q){if(!l)g.stop(q);}},n=new j(location.href);if(n.getSubdomain()&&n.getSubdomain()!=='www')n.setSubdomain('www');var o=n.getDomain();function p(){if(k.ie()<9)return false;return i.isSupported()&&h.supportsRPC();}if(n.isFacebookURI()&&location.host!==o&&p()){l=document.createElement('iframe');l.setAttribute('src','//'+o+'/sound_iframe.php');l.style.display='none';document.body.appendChild(l);}e.exports=m;});